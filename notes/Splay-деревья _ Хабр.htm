<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>Splay-деревья / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.76652d4b.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.a3ff8f09.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.9cdf9b0e.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.344a2afd.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.76652d4b.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.9cdf9b0e.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.6aa513a2e8a86335c6bf81d4cfd55980.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/JetBrains-education\/blog\/210296\/"},"headline":"Splay-деревья","datePublished":"2014-02-22T12:38:33+04:00","dateModified":"2016-06-02T13:43:50+03:00","author":{"@type":"Person","name":"Vsevolod Oparin"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, A...","url":"https:\/\/habr.com\/ru\/company\/JetBrains-education\/blog\/210296\/#post-content-body","about":["c_JetBrains-education","h_algorithms","h_maths","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/c7f\/092\/d48\/c7f092d481acb49c8a0f96178ceb3119.gif","https:\/\/tex.s2cms.ru\/svg\/m","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/076\/63d\/c3c\/07663dc3c790b8c5e111597f71b68abc.gif","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/7be\/274\/948\/7be27494810106e7a26b615c21f37527.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/84c\/07b\/cc9\/84c07bcc99d5fc8ab9086ace521ed96a.gif","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/58b\/97d\/c8b\/58b97dc8bf8293538e48a34716f4e1f5.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/13c\/2ec\/397\/13c2ec39790be792f792fe393db53be5.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/ccf\/9f3\/f52\/ccf9f3f52fea0caa23df9070d4833bc3.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/36e\/527\/090\/36e527090c0e49bf48ba45d20fb780f7.png","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/ec7\/176\/ecf\/ec7176ecffb2f187d5ef0d0d24ffdbd4.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/2c4\/55f\/6c3\/2c455f6c331507d8415d138c126d5cd1.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/801\/e91\/678\/801e916781182638bdd30f434f6dd79f.gif","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/2a4\/a15\/263\/2a4a15263185920396d9b74a66fda10e.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/01e\/fed\/dbf\/01efeddbf29cf53eddad0eb121c3865c.gif","http:\/\/tex.s2cms.ru\/svg\/h","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/b94\/550\/354\/b94550354872977b0f0aad8cda86789e.gif","http:\/\/tex.s2cms.ru\/svg\/r","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/bac\/598\/191\/bac5981912a4b3785f398a37163010ec.gif","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/bd2\/e8c\/4de\/bd2e8c4deee380873258074067f47a79.gif","http:\/\/tex.s2cms.ru\/svg\/i","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/45a\/141\/2de\/45a1412deeddf95d0291a61419916399.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/514\/7e6\/520\/5147e652057fc82f5cc918ad29f95543.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/3a7\/c5a\/d43\/3a7c5ad43334e60bfd005218c4a6cf67.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/72d\/3e4\/837\/72d3e4837c9cbdce557c78e41a136e51.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/3d4\/903\/c4a\/3d4903c4a6ab562fa149407b12cbdd95.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/a10\/2e6\/672\/a102e6672264a72c4d01f4c1ef352345.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/26f\/ff1\/377\/26fff1377fd5ee7a18d590a322203e05.gif","http:\/\/tex.s2cms.ru\/svg\/v","http:\/\/tex.s2cms.ru\/svg\/r","http:\/\/habrastorage.org\/files\/bd9\/d53\/7e5\/bd9d537e58a24dfb94445b704a903153.png","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/e61\/061\/e90\/e61061e90cf933cf6ec28f8d25e905d7.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/155\/bde\/9f5\/155bde9f50a1332adbefa9c833ae068f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/ad2\/d15\/a8d\/ad2d15a8df39e0b455d90f44a350d356.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/270\/cbb\/bb6\/270cbbbb6cb0b4c0634e86f443bd3ab6.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/0ca\/37d\/0b1\/0ca37d0b18e353c266d5b324d89a156f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/e8e\/aea\/72f\/e8eaea72f1417fc4e5e0d7a0cc887ef1.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/95c\/007\/330\/95c0073302d8e83f0658373bf031d628.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/778\/167\/ba0\/778167ba0bfe8d797c1444241533f806.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/4f9\/ca1\/b1c\/4f9ca1b1c8029535c88032fbe0b24b60.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/8ca\/ebe\/078\/8caebe078b8f5a33590e85caea5439cd.gif","https:\/\/habrastorage.org\/files\/566\/742\/2e5\/5667422e5f6a4b17b1936349921a2a62.png","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/f88\/07b\/f37\/f8807bf37fe6b7b3233fef522b691a4a.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/155\/bde\/9f5\/155bde9f50a1332adbefa9c833ae068f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/8ca\/ebe\/078\/8caebe078b8f5a33590e85caea5439cd.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/9e6\/f72\/cc4\/9e6f72cc4496cad479eee6dfb081b61c.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/270\/cbb\/bb6\/270cbbbb6cb0b4c0634e86f443bd3ab6.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/008\/61a\/f75\/00861af757b1c0f16fdd2a82525d278e.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/e75\/31c\/f9f\/e7531cf9f42d16323412064c7f4f5fe6.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/d52\/059\/7a0\/d520597a0b03a29b8c707e8c848c0c3c.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/da2\/0bd\/041\/da20bd0413ddd7abb2c6a1124a70ed1f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/385\/49c\/6e6\/38549c6e67f5913b05c03db9e23f0966.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/8d1\/be0\/29f\/8d1be029f449db8442cfb9b5e81cd7f6.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/ab1\/b92\/dcc\/ab1b92dcc990d3ac0f39df4e4ece7ec0.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/269\/10c\/32f\/26910c32f49a0473c0bf8b9aea4d6158.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/f8f\/dbd\/a6d\/f8fdbda6d98e4b55cef1518928558774.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/cb8\/e8e\/c07\/cb8e8ec07a4a7872b6acaf707d6e673f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/c80\/d13\/d58\/c80d13d587a00fca58b429e785e3c06a.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/76b\/3b1\/ea4\/76b3b1ea4f0c87f8fc93e7f66faf333b.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/a93\/276\/f12\/a93276f12dd9474eb7fef7a83748cebf.gif","https:\/\/habrastorage.org\/files\/fd0\/b05\/323\/fd0b0532300a4e98b6089883319524c8.png","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/f88\/07b\/f37\/f8807bf37fe6b7b3233fef522b691a4a.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/155\/bde\/9f5\/155bde9f50a1332adbefa9c833ae068f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/8ca\/ebe\/078\/8caebe078b8f5a33590e85caea5439cd.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/270\/cbb\/bb6\/270cbbbb6cb0b4c0634e86f443bd3ab6.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/0c5\/232\/69d\/0c523269dbad8d147f278380b9d4cb76.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/11e\/019\/6f0\/11e0196f041a65b9712d2128d106eeaf.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/a8e\/bdf\/07e\/a8ebdf07e1219a23c6f51afadcf2d768.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/84c\/07b\/cc9\/84c07bcc99d5fc8ab9086ace521ed96a.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/cad\/4e8\/f95\/cad4e8f9585700a0a979e4d098851bb4.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/882\/839\/fd0\/882839fd0d8c0796ef0f881d89ac3705.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/601\/5f7\/e7e\/6015f7e7e19971bf1372e01171eaadcb.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/4e4\/afc\/38a\/4e4afc38a83dfc386be50875ee0dd12f.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/41c\/9fd\/590\/41c9fd5903fa785884a1325457399279.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/12f\/ee3\/928\/12fee3928922dbe461d4bd49abc7df24.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/601\/5f7\/e7e\/6015f7e7e19971bf1372e01171eaadcb.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/65d\/250\/85a\/65d25085aec30c33ef47e960ff608e05.gif","http:\/\/habrastorage.org\/getpro\/habr\/post_images\/39a\/ed9\/498\/39aed9498a90431e37a7b32ffe2338cd.gif"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.90.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Splay-деревья" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Splay-деревья" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Splay-деревья" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="210296" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2014-02-22T08:38:33.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/company/JetBrains-education/blog/210296/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="структуры данных, splay-деревья, сбалансированные деревья, амортизационный анализ">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/210296/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/JetBrains-education/blog/210296/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habr.com/share/publication/210296/707c775ac60e40a686ac792b0e702b3a/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header data-test-id="header" class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" data-test-id="search-button" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="JetBrains-education" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a href="/ru/company/JetBrains-education/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/6f4/fce/9bc/6f4fce9bc46008c75d3b4922942730a8.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter tm-rating__counter">0</div></div> <div class="tm-rating__text tm-rating__text">
    Рейтинг
  </div></div> <!----></div> <div class="tm-company-card__info"><a href="/ru/company/JetBrains-education/profile/" class="tm-company-card__name">Образовательные проекты JetBrains</a> <div class="tm-company-card__description"></div></div></div> <!----></div> <div data-test-id="article-body" class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2014-02-22T08:38:33.000Z" title="2014-02-22, 12:38">22  февраля  2014 в 12:38</time></span></div> <!----></div> <h1 data-test-id="articleTitle" lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Splay-деревья</span></h1> <div data-test-id="articleHubsList" class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/JetBrains-education/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Образовательные проекты JetBrains</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/maths/" class="tm-article-snippet__hubs-item-link"><span>Математика</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div data-test-id="articleLabels" class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label tm-article-snippet__label_variant-tutorial"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других сбалансированных деревьев. Но является ли перманентная сбалансированность тем Святым Граалем, за которым следует гоняться?<br/>
<br/>
Представим, что мы уже построили дерево на <img src="https://habrastorage.org/getpro/habr/post_images/c7f/092/d48/c7f092d481acb49c8a0f96178ceb3119.gif" data-src="https://habrastorage.org/getpro/habr/post_images/c7f/092/d48/c7f092d481acb49c8a0f96178ceb3119.gif"/> ключах и теперь нам нужно отвечать на запросы, лежит ли заданный ключ в дереве. Может так оказаться, что пользователя интересует в основном один ключ, и остальные он запрашивает только время от времени. Если ключ лежит далеко от корня, то <img src="https://tex.s2cms.ru/svg/m"/> запросов могут отнять <img src="https://habrastorage.org/getpro/habr/post_images/076/63d/c3c/07663dc3c790b8c5e111597f71b68abc.gif" data-src="https://habrastorage.org/getpro/habr/post_images/076/63d/c3c/07663dc3c790b8c5e111597f71b68abc.gif"/> времени. Здравый смысл подсказывает, что оценку можно оптимизировать до <img src="https://habrastorage.org/getpro/habr/post_images/7be/274/948/7be27494810106e7a26b615c21f37527.gif" data-src="https://habrastorage.org/getpro/habr/post_images/7be/274/948/7be27494810106e7a26b615c21f37527.gif"/>, надстроив над деревом кэш. Но этот подход имеет некоторый недостаток гибкости и элегантности.<br/>
<br/>
Сегодня я расскажу о splay-деревьях. Эти деревья не являются перманентно сбалансированными и на отдельных запросах могут работать даже линейное время. Однако, после каждого запроса они меняют свою структуру, что позволяет очень эффективно обрабатывать часто повторяющиеся запросы. Более того, амортизационная стоимость обработки одного запроса у них <img src="http://habrastorage.org/getpro/habr/post_images/84c/07b/cc9/84c07bcc99d5fc8ab9086ace521ed96a.gif" data-src="http://habrastorage.org/getpro/habr/post_images/84c/07b/cc9/84c07bcc99d5fc8ab9086ace521ed96a.gif"/>, что делает splay-деревья хорошей альтернативой для перманентно сбалансированных собратьев.<br/>
<a name="habracut"></a><br/>
<h4>Splay-деревья</h4><br/>
В середине восьмидесятых Роберт Тарьян и Даниель Слейтор предложили несколько красивых и эффективных структур данных. Все они имеют несложную базовую структуру и одну-две эвристики, которые их постоянно локально подправляют. Splay-дерево — одна из таких структур.<br/>
<br/>
Splay-дерево — это самобалансирующееся бинарное дерево поиска. Дереву не нужно хранить никакой дополнительной информации, что делает его эффективным по памяти. После каждого обращения, даже поиска, splay-дерево меняет свою структуру. <br/>
<br/>
Ниже я опишу алгоритм, как работает дерево на наборе попарно различных ключей, а потом приведу его анализ. <br/>
<br/>
<h4>Алгоритм</h4><br/>
Для описания структуры дерева нам пригодится простенький класс, описывающий отдельную вершину,<br/>
<br/>
<pre><code class="python">class Node:
  def __init__(self, key, left = None, right = None, parent = None):
    self.left   = left
    self.right  = right
    self.parent = parent
    self.key    = key
</code></pre><br/>
и две вспомогательные процедуры для работы с указателями на родителей.<br/>
<br/>
<pre><code class="python">def set_parent(child, parent):
  if child != None:
    child.parent = parent

def keep_parent(v):
  set_parent(v.left, v)
  set_parent(v.right, v)
</code></pre><br/>
Основная эвристика splay-дерева — move-to-root. После обращения к любой вершине, она поднимается в корень. Подъем реализуется через повороты вершин. За один поворот, можно поменять местами родителя с ребенком, как показано на рисунке ниже.<br/>
<br/>
<img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/58b/97d/c8b/58b97dc8bf8293538e48a34716f4e1f5.png" data-src="https://habrastorage.org/getpro/habr/post_images/58b/97d/c8b/58b97dc8bf8293538e48a34716f4e1f5.png"/><br/>
<br/>
<pre><code class="python">def rotate(parent, child):
  gparent = parent.parent
  if gparent != None:
    if gparent.left == parent:
      gparent.left = child
    else:
      gparent.right = child

  if parent.left == child:
    parent.left, child.right = child.right, parent
  else:
    parent.right, child.left = child.left, parent

  keep_parent(child)
  keep_parent(parent)
  child.parent = gparent
</code></pre><br/>
Но просто поворачивать вершину, пока она не станет корнем, недостаточно. Хитрость splay-дерева в том, что при продвижении вершины вверх, расстояние до корня сокращается не только для поднимаемой вершины, но и для всех ее потомков в текущих поддеревьях. Для этого используется техника zig-zig и zig-zag поворотов.<br/>
<br/>
Основная идея zig-zig и zig-zag поворотов, рассмотреть путь от дедушки к ребенку. Если путь идет только по левым детям или только по правым, то такая ситуация называется zig-zig. Как ее обрабатывать показано на рисунке ниже. Сначала повернуть родителя, потом ребенка.<br/>
<br/>
<img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/13c/2ec/397/13c2ec39790be792f792fe393db53be5.png" data-src="https://habrastorage.org/getpro/habr/post_images/13c/2ec/397/13c2ec39790be792f792fe393db53be5.png"/><br/>
<br/>
В противном случае, мы сначала меняем ребенка с текущим родителем, потом с новым.<br/>
<br/>
<img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/ccf/9f3/f52/ccf9f3f52fea0caa23df9070d4833bc3.png" data-src="https://habrastorage.org/getpro/habr/post_images/ccf/9f3/f52/ccf9f3f52fea0caa23df9070d4833bc3.png"/><br/>
<br/>
Если у вершины дедушки нет, делаем обычный поворот:<br/>
<br/>
<img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/36e/527/090/36e527090c0e49bf48ba45d20fb780f7.png" data-src="https://habrastorage.org/getpro/habr/post_images/36e/527/090/36e527090c0e49bf48ba45d20fb780f7.png"/><br/>
<br/>
Описанная выше процедура поднятия вершины с помощью zig-zig и zig-zag поворотов является ключевой для splay-дерева.<br/>
<br/>
<b>Примечание</b>. В русском языке термин «splay» перевели как «расширять». Мне кажется, это не очень удачный перевод. Вы берете вершину и тянете ее наверх. В это время все другие вершины уходят вниз, поворачиваясь вокруг нее. Нечто похожее происходит, когда вы выворачиваете футболку. Так что слово «выворачивать» кажется здесь более подходящим.<br/>
<br/>
<pre><code class="python">def splay(v):
  if v.parent == None:
    return v
  parent = v.parent
  gparent = parent.parent
  if gparent == None:
    rotate(parent, v) 
    return v    
  else:
    zigzig = (gparent.left == parent) == (parent.left == v)
    if zigzig:
      rotate(gparent, parent)
      rotate(parent, v)
    else:
      rotate(parent, v)
      rotate(gparent, v)
    return splay(v)
</code></pre><br/>
Процедура поиска в splay-дереве отличается от обычной только на последней стадии: после того, как вершина найдена, мы тянем ее вверх и делаем корнем через процедуру <code>splay</code>.<br/>
<br/>
<pre><code class="python">def find(v, key):
  if v == None:
    return None
  if key == v.key:
    return splay(v)
  if key &lt; v.key and v.left != None:
    return find(v.left, key)
  if key > v.key and v.right != None:
    return find(v.right, key)
  return splay(v)
</code></pre><br/>
Чтобы реализовать вставку и удаление ключа, нам потребуются две процедуры: <code>split</code> и <code>merge</code> (разрезать и слить). <br/>
<br/>
Процедура <code>split</code> получает на вход ключ <code>key</code> и делит дерево на два. В одном дереве все значения меньше ключа <code>key</code>, а в другом — больше. Реализуется она просто. Нужно через <code>find</code> найти ближайшую к ключу вершину, вытянуть ее вверх и потом отрезать либо левое, либо правое поддерево (либо оба).<br/>
<br/>
<pre><code class="python">def split(root, key):
  if root == None:
    return None, None
  root = find(root, key)
  if root.key == key:
    set_parent(root.left, None)
    set_parent(root.right, None)
    return root.left, root.right
  if root.key &lt; key:
    right, root.right = root.right, None
    set_parent(right, None)
    return root, right
  else:
    left, root.left = root.left, None
    set_parent(left, None)
    return left, root 
</code></pre><br/>
Чтобы вставить очередной ключ, достаточно вызвать <code>split</code> по нему, а затем сделать новую вершину-корень, у которой поддеревьями будет результат <code>split</code>-а.<br/>
<pre><code class="python">def insert(root, key):
  left, right = split(root, key)
  root = Node(key, left, right)
  keep_parent(root)
  return root
</code></pre><br/>
Процедура <code>merge</code> получает на вход два дерева: левое <code>left</code> и правое <code>right</code>. Для корректной работы, ключи дерева <code>left</code> должны быть меньше ключей дерева <code>right</code>. Здесь мы берем вершину с наименьшим ключом правого дерева <code>right</code> и тянем ее вверх. После этого в качестве левого поддерева присоединяем дерево <code>left</code>.<br/>
<br/>
<pre><code class="python">def merge(left, right):
  if right == None:
    return left
  if left == None:
    return right
  right = find(right, left.key)
  right.left, left.parent = left, right
  return right
</code></pre><br/>
Для того, чтобы удалить вершину, нужно поднять ее вверх, а потом слить ее левые и правые поддеревья.<br/>
<br/>
<pre><code class="python">def remove(root, key):
  root = find(root, key)
  set_parent(root.left, None)
  set_parent(root.right, None)
  return merge(root.left, root.right)
</code></pre><br/>
Чтобы splay-дерево поддерживало повторяющиеся ключи, можно поступить двумя способами. Нужно либо каждому ключу сопоставить список, хранящий нужную доп. информацию, либо реализовать процедуру find так, чтобы она возвращала первую в порядке обхода LUR вершину с ключом, большим либо равным заданного.<br/>
<br/>
<h4>Анализ</h4><br/>
Заметим, что процедуры удаления, вставки, слияния и разделения деревьев работают за <img src="http://habrastorage.org/getpro/habr/post_images/ec7/176/ecf/ec7176ecffb2f187d5ef0d0d24ffdbd4.gif" data-src="http://habrastorage.org/getpro/habr/post_images/ec7/176/ecf/ec7176ecffb2f187d5ef0d0d24ffdbd4.gif"/> + время работы процедуры <code>find</code>.<br/>
<br/>
Процедура <code>find</code> работает пропорционально глубине искомой вершины в дереве. По завершении поиска запускается процедура <code>splay</code>, которая тоже работает пропорционально глубине вершины. Таким образом, достаточно оценить время работы процедуры <code>splay</code>.<br/>
<br/>
Для анализа воспользуемся методом физика, про который я рассказывал в статье про <a href="http://habrahabr.ru/post/208624">амортизационный анализ</a>. Пусть <img src="http://habrastorage.org/getpro/habr/post_images/2c4/55f/6c3/2c455f6c331507d8415d138c126d5cd1.gif" data-src="http://habrastorage.org/getpro/habr/post_images/2c4/55f/6c3/2c455f6c331507d8415d138c126d5cd1.gif"/> — размер поддерева <img src="http://habrastorage.org/getpro/habr/post_images/801/e91/678/801e916781182638bdd30f434f6dd79f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/801/e91/678/801e916781182638bdd30f434f6dd79f.gif"/> с корнем в вершине <img src="http://tex.s2cms.ru/svg/v"/>. Рангом вершины <img src="http://tex.s2cms.ru/svg/v"/> назовем величину <img src="http://habrastorage.org/getpro/habr/post_images/2a4/a15/263/2a4a15263185920396d9b74a66fda10e.gif" data-src="http://habrastorage.org/getpro/habr/post_images/2a4/a15/263/2a4a15263185920396d9b74a66fda10e.gif"/>. Наш потенциал будет <img src="http://habrastorage.org/getpro/habr/post_images/01e/fed/dbf/01efeddbf29cf53eddad0eb121c3865c.gif" data-src="http://habrastorage.org/getpro/habr/post_images/01e/fed/dbf/01efeddbf29cf53eddad0eb121c3865c.gif"/>.<br/>
<br/>
Будем считать, что фактическое время процедуры <code>splay(v)</code> равно глубине <img src="http://tex.s2cms.ru/svg/h"/> вершины <img src="http://tex.s2cms.ru/svg/v"/>. Отметим, что это также равно числу элементарных поворотов, которые будут выполнены в ходе процедуры.<br/>
<br/>
<b>Утверждение</b>. Амортизационная стоимость операции <code>splay</code> от вершины <img src="http://tex.s2cms.ru/svg/v"/> в дереве <img src="http://habrastorage.org/getpro/habr/post_images/b94/550/354/b94550354872977b0f0aad8cda86789e.gif" data-src="http://habrastorage.org/getpro/habr/post_images/b94/550/354/b94550354872977b0f0aad8cda86789e.gif"/> с корнем <img src="http://tex.s2cms.ru/svg/r"/> составляет <img src="http://habrastorage.org/getpro/habr/post_images/bac/598/191/bac5981912a4b3785f398a37163010ec.gif" data-src="http://habrastorage.org/getpro/habr/post_images/bac/598/191/bac5981912a4b3785f398a37163010ec.gif"/>.<br/>
<br/>
<b>Доказательство</b>. <br/>
Если <img src="http://tex.s2cms.ru/svg/v"/> — корень, то утверждение очевидно. В противном случае разделим процедуру <code>splay(v)</code> на этапы. В ходе каждого этапа выполняется один из трех поворотов: zig, zig-zig или zig-zag. На простой поворот уходит единица времени, на zig-zig и zig-zag — две единицы.<br/>
<br/>
После каждого этапа ранг вершины <img src="http://tex.s2cms.ru/svg/v"/> будет меняться. Пусть изначально ранг составляет <img src="http://habrastorage.org/getpro/habr/post_images/bd2/e8c/4de/bd2e8c4deee380873258074067f47a79.gif" data-src="http://habrastorage.org/getpro/habr/post_images/bd2/e8c/4de/bd2e8c4deee380873258074067f47a79.gif"/>, а после <img src="http://tex.s2cms.ru/svg/i"/>-ого этапа — <img src="http://habrastorage.org/getpro/habr/post_images/45a/141/2de/45a1412deeddf95d0291a61419916399.gif" data-src="http://habrastorage.org/getpro/habr/post_images/45a/141/2de/45a1412deeddf95d0291a61419916399.gif"/>. Для каждого этапа, кроме, быть может, последнего, мы покажем, что амортизационное время на его выполнение можно ограничить сверху величиной <img src="http://habrastorage.org/getpro/habr/post_images/514/7e6/520/5147e652057fc82f5cc918ad29f95543.gif" data-src="http://habrastorage.org/getpro/habr/post_images/514/7e6/520/5147e652057fc82f5cc918ad29f95543.gif"/>. Для последнего этапа верхняя оценка составит <img src="http://habrastorage.org/getpro/habr/post_images/3a7/c5a/d43/3a7c5ad43334e60bfd005218c4a6cf67.gif" data-src="http://habrastorage.org/getpro/habr/post_images/3a7/c5a/d43/3a7c5ad43334e60bfd005218c4a6cf67.gif"/>. Просуммировав верхние оценки и сократив промежуточные значения рангов мы получим требуемое<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/getpro/habr/post_images/72d/3e4/837/72d3e4837c9cbdce557c78e41a136e51.gif" data-src="http://habrastorage.org/getpro/habr/post_images/72d/3e4/837/72d3e4837c9cbdce557c78e41a136e51.gif"/></div><br/>
<br/>
Нужно только заметить, что <img src="http://habrastorage.org/getpro/habr/post_images/3d4/903/c4a/3d4903c4a6ab562fa149407b12cbdd95.gif" data-src="http://habrastorage.org/getpro/habr/post_images/3d4/903/c4a/3d4903c4a6ab562fa149407b12cbdd95.gif"/>, а <img src="http://habrastorage.org/getpro/habr/post_images/a10/2e6/672/a102e6672264a72c4d01f4c1ef352345.gif" data-src="http://habrastorage.org/getpro/habr/post_images/a10/2e6/672/a102e6672264a72c4d01f4c1ef352345.gif"/>.<br/>
<br/>
Теперь разберем каждый тип поворота отдельно.<br/>
<br/>
Zig. Может выполняться только один раз, на последнем этапе. Фактическое время <img src="http://habrastorage.org/getpro/habr/post_images/26f/ff1/377/26fff1377fd5ee7a18d590a322203e05.gif" data-src="http://habrastorage.org/getpro/habr/post_images/26f/ff1/377/26fff1377fd5ee7a18d590a322203e05.gif"/>. Посмотрим на рисунок и поймем, что ранги меняются только у вершин <img src="http://tex.s2cms.ru/svg/v"/> и <img src="http://tex.s2cms.ru/svg/r"/>.<br/>
<br/>
<img src="http://habrastorage.org/r/w1560/files/bd9/d53/7e5/bd9d537e58a24dfb94445b704a903153.png" data-src="http://habrastorage.org/files/bd9/d53/7e5/bd9d537e58a24dfb94445b704a903153.png"/><br/>
<br/>
Значит, амортизационная стоимость составит <img src="http://habrastorage.org/getpro/habr/post_images/e61/061/e90/e61061e90cf933cf6ec28f8d25e905d7.gif" data-src="http://habrastorage.org/getpro/habr/post_images/e61/061/e90/e61061e90cf933cf6ec28f8d25e905d7.gif"/>. Ранги <img src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif"/> и <img src="http://habrastorage.org/getpro/habr/post_images/ad2/d15/a8d/ad2d15a8df39e0b455d90f44a350d356.gif" data-src="http://habrastorage.org/getpro/habr/post_images/ad2/d15/a8d/ad2d15a8df39e0b455d90f44a350d356.gif"/> сокращаются. Исходя из размеров соответствующих поддеревьев применим к формуле <img src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif" data-src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif"/> неравенство:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/getpro/habr/post_images/0ca/37d/0b1/0ca37d0b18e353c266d5b324d89a156f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/0ca/37d/0b1/0ca37d0b18e353c266d5b324d89a156f.gif"/></div><br/>
<br/>
Значит, <img src="http://habrastorage.org/getpro/habr/post_images/e8e/aea/72f/e8eaea72f1417fc4e5e0d7a0cc887ef1.gif" data-src="http://habrastorage.org/getpro/habr/post_images/e8e/aea/72f/e8eaea72f1417fc4e5e0d7a0cc887ef1.gif"/>.<br/>
<br/>
Zig-zig. Фактическое время <img src="http://habrastorage.org/getpro/habr/post_images/95c/007/330/95c0073302d8e83f0658373bf031d628.gif" data-src="http://habrastorage.org/getpro/habr/post_images/95c/007/330/95c0073302d8e83f0658373bf031d628.gif"/>. Заметим, что ранги меняются только у вершин <img src="http://habrastorage.org/getpro/habr/post_images/778/167/ba0/778167ba0bfe8d797c1444241533f806.gif" data-src="http://habrastorage.org/getpro/habr/post_images/778/167/ba0/778167ba0bfe8d797c1444241533f806.gif"/>, <img src="http://habrastorage.org/getpro/habr/post_images/4f9/ca1/b1c/4f9ca1b1c8029535c88032fbe0b24b60.gif" data-src="http://habrastorage.org/getpro/habr/post_images/4f9/ca1/b1c/4f9ca1b1c8029535c88032fbe0b24b60.gif"/> и <img src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif" data-src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif"/>.<br/>
<br/>
<img src="//habrastorage.org/r/w1560/files/566/742/2e5/5667422e5f6a4b17b1936349921a2a62.png" data-src="//habrastorage.org/files/566/742/2e5/5667422e5f6a4b17b1936349921a2a62.png"/><br/>
<br/>
Тогда амортизационная стоимость <img src="http://habrastorage.org/getpro/habr/post_images/f88/07b/f37/f8807bf37fe6b7b3233fef522b691a4a.gif" data-src="http://habrastorage.org/getpro/habr/post_images/f88/07b/f37/f8807bf37fe6b7b3233fef522b691a4a.gif"/>. Ранги <img src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif"/> и <img src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif" data-src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif"/> можно сократить. Получим, что <img src="http://habrastorage.org/getpro/habr/post_images/9e6/f72/cc4/9e6f72cc4496cad479eee6dfb081b61c.gif" data-src="http://habrastorage.org/getpro/habr/post_images/9e6/f72/cc4/9e6f72cc4496cad479eee6dfb081b61c.gif"/>. Исходя из размеров поддеревьев применим к формуле <img src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif" data-src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif"/> два неравенства:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/getpro/habr/post_images/008/61a/f75/00861af757b1c0f16fdd2a82525d278e.gif" data-src="http://habrastorage.org/getpro/habr/post_images/008/61a/f75/00861af757b1c0f16fdd2a82525d278e.gif"/></div><br/>
<br/>
и получим, что <img src="http://habrastorage.org/getpro/habr/post_images/e75/31c/f9f/e7531cf9f42d16323412064c7f4f5fe6.gif" data-src="http://habrastorage.org/getpro/habr/post_images/e75/31c/f9f/e7531cf9f42d16323412064c7f4f5fe6.gif"/>.<br/>
<br/>
Наша цель — показать, что <img src="http://habrastorage.org/getpro/habr/post_images/d52/059/7a0/d520597a0b03a29b8c707e8c848c0c3c.gif" data-src="http://habrastorage.org/getpro/habr/post_images/d52/059/7a0/d520597a0b03a29b8c707e8c848c0c3c.gif"/>. Для этого достаточно показать, что <img src="http://habrastorage.org/getpro/habr/post_images/da2/0bd/041/da20bd0413ddd7abb2c6a1124a70ed1f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/da2/0bd/041/da20bd0413ddd7abb2c6a1124a70ed1f.gif"/>:<br/>
<br/>
<img src="http://habrastorage.org/getpro/habr/post_images/385/49c/6e6/38549c6e67f5913b05c03db9e23f0966.gif" data-src="http://habrastorage.org/getpro/habr/post_images/385/49c/6e6/38549c6e67f5913b05c03db9e23f0966.gif"/><br/>
<br/>
Для удобства перенесем ранги в левую часть и будем доказывать <img src="http://habrastorage.org/getpro/habr/post_images/8d1/be0/29f/8d1be029f449db8442cfb9b5e81cd7f6.gif" data-src="http://habrastorage.org/getpro/habr/post_images/8d1/be0/29f/8d1be029f449db8442cfb9b5e81cd7f6.gif"/>. По определению ранга <img src="http://habrastorage.org/getpro/habr/post_images/ab1/b92/dcc/ab1b92dcc990d3ac0f39df4e4ece7ec0.gif" data-src="http://habrastorage.org/getpro/habr/post_images/ab1/b92/dcc/ab1b92dcc990d3ac0f39df4e4ece7ec0.gif"/>. Последнее равенство разобъем на сумму <img src="http://habrastorage.org/getpro/habr/post_images/269/10c/32f/26910c32f49a0473c0bf8b9aea4d6158.gif" data-src="http://habrastorage.org/getpro/habr/post_images/269/10c/32f/26910c32f49a0473c0bf8b9aea4d6158.gif"/>. Посмотрим на рисунок и поймем, что <img src="http://habrastorage.org/getpro/habr/post_images/f8f/dbd/a6d/f8fdbda6d98e4b55cef1518928558774.gif" data-src="http://habrastorage.org/getpro/habr/post_images/f8f/dbd/a6d/f8fdbda6d98e4b55cef1518928558774.gif"/>.<br/>
<br/>
<b>Факт</b>. <img src="http://habrastorage.org/getpro/habr/post_images/cb8/e8e/c07/cb8e8ec07a4a7872b6acaf707d6e673f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/cb8/e8e/c07/cb8e8ec07a4a7872b6acaf707d6e673f.gif"/> для любых положительных <img src="http://habrastorage.org/getpro/habr/post_images/c80/d13/d58/c80d13d587a00fca58b429e785e3c06a.gif" data-src="http://habrastorage.org/getpro/habr/post_images/c80/d13/d58/c80d13d587a00fca58b429e785e3c06a.gif"/> таких, что <img src="http://habrastorage.org/getpro/habr/post_images/76b/3b1/ea4/76b3b1ea4f0c87f8fc93e7f66faf333b.gif" data-src="http://habrastorage.org/getpro/habr/post_images/76b/3b1/ea4/76b3b1ea4f0c87f8fc93e7f66faf333b.gif"/>.<br/>
 <br/>
Значит, <img src="http://habrastorage.org/getpro/habr/post_images/a93/276/f12/a93276f12dd9474eb7fef7a83748cebf.gif" data-src="http://habrastorage.org/getpro/habr/post_images/a93/276/f12/a93276f12dd9474eb7fef7a83748cebf.gif"/>. Получили требуемое.<br/>
<br/>
Zig-zag. <br/>
<br/>
<img src="//habrastorage.org/r/w1560/files/fd0/b05/323/fd0b0532300a4e98b6089883319524c8.png" data-src="//habrastorage.org/files/fd0/b05/323/fd0b0532300a4e98b6089883319524c8.png"/><br/>
<br/>
Аналогично предыдущему случаю запишем амортизационную оценку: <img src="http://habrastorage.org/getpro/habr/post_images/f88/07b/f37/f8807bf37fe6b7b3233fef522b691a4a.gif" data-src="http://habrastorage.org/getpro/habr/post_images/f88/07b/f37/f8807bf37fe6b7b3233fef522b691a4a.gif"/>.<br/>
<br/>
Ранги <img src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/155/bde/9f5/155bde9f50a1332adbefa9c833ae068f.gif"/> и <img src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif" data-src="http://habrastorage.org/getpro/habr/post_images/8ca/ebe/078/8caebe078b8f5a33590e85caea5439cd.gif"/> сокращаются. К формуле <img src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif" data-src="http://habrastorage.org/getpro/habr/post_images/270/cbb/bb6/270cbbbb6cb0b4c0634e86f443bd3ab6.gif"/> применим следующие неравенства:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/getpro/habr/post_images/0c5/232/69d/0c523269dbad8d147f278380b9d4cb76.gif" data-src="http://habrastorage.org/getpro/habr/post_images/0c5/232/69d/0c523269dbad8d147f278380b9d4cb76.gif"/></div><br/>
<br/>
Значит, <img src="http://habrastorage.org/getpro/habr/post_images/11e/019/6f0/11e0196f041a65b9712d2128d106eeaf.gif" data-src="http://habrastorage.org/getpro/habr/post_images/11e/019/6f0/11e0196f041a65b9712d2128d106eeaf.gif"/>. Это неравенство доказывается аналогично предыдущему случаю.<br/>
<br/>
Таким образом мы разобрали все три случая и получили верхнюю оценку на амортизированное время через ранги. <img src="http://habrastorage.org/getpro/habr/post_images/a8e/bdf/07e/a8ebdf07e1219a23c6f51afadcf2d768.gif" data-src="http://habrastorage.org/getpro/habr/post_images/a8e/bdf/07e/a8ebdf07e1219a23c6f51afadcf2d768.gif"/><br/>
<br/>
Осталось заметить, что ранг любой вершины ограничен логарифмом размера дерева. Из чего следует следующая теорема.<br/>
<br/>
<b>Теорема</b>. Операция <code>splay</code> амортизационно выполняется за <img src="http://habrastorage.org/getpro/habr/post_images/84c/07b/cc9/84c07bcc99d5fc8ab9086ace521ed96a.gif" data-src="http://habrastorage.org/getpro/habr/post_images/84c/07b/cc9/84c07bcc99d5fc8ab9086ace521ed96a.gif"/>.<br/>
<br/>
<h4>Другие метрики и свойства</h4><br/>
На десерт я хотел бы сослаться на <a href="http://en.wikipedia.org/wiki/Splay_tree">википедию</a> и представить здесь несколько интересных фактов про <code>splay</code>-деревья.<br/>
<br/>
<b>Теорема о статической оптимальности</b>. Пусть <img src="http://habrastorage.org/getpro/habr/post_images/cad/4e8/f95/cad4e8f9585700a0a979e4d098851bb4.gif" data-src="http://habrastorage.org/getpro/habr/post_images/cad/4e8/f95/cad4e8f9585700a0a979e4d098851bb4.gif"/> — число раз, которое был запрошен элемент <img src="http://habrastorage.org/getpro/habr/post_images/882/839/fd0/882839fd0d8c0796ef0f881d89ac3705.gif" data-src="http://habrastorage.org/getpro/habr/post_images/882/839/fd0/882839fd0d8c0796ef0f881d89ac3705.gif"/>. Тогда выполнение <img src="http://habrastorage.org/getpro/habr/post_images/601/5f7/e7e/6015f7e7e19971bf1372e01171eaadcb.gif" data-src="http://habrastorage.org/getpro/habr/post_images/601/5f7/e7e/6015f7e7e19971bf1372e01171eaadcb.gif"/> запросов поиска на <code>splay</code>-дереве выполняется за <img src="http://habrastorage.org/getpro/habr/post_images/4e4/afc/38a/4e4afc38a83dfc386be50875ee0dd12f.gif" data-src="http://habrastorage.org/getpro/habr/post_images/4e4/afc/38a/4e4afc38a83dfc386be50875ee0dd12f.gif"/>.<br/>
<br/>
По сути этот факт сообщает следующее. Пусть мы заранее знаем, в каком количестве будут заданы запросы для различных элементов. Мы строим какое-то конкретное бинарное дерево, чтобы отвечать на эти запросы как можно быстрее. Утверждение сообщает, что с точностью до константы <code>splay</code>-дерево будет амортизационно работать не хуже, чем самое оптимальное фиксированное дерево, которое мы можем придумать. <br/>
<br/>
<b>Теорема о текущем множестве</b>. Пусть <img src="http://habrastorage.org/getpro/habr/post_images/41c/9fd/590/41c9fd5903fa785884a1325457399279.gif" data-src="http://habrastorage.org/getpro/habr/post_images/41c/9fd/590/41c9fd5903fa785884a1325457399279.gif"/> — это число запросов, которое мы уже совершили с момента последнего запроса к элементу <img src="http://habrastorage.org/getpro/habr/post_images/12f/ee3/928/12fee3928922dbe461d4bd49abc7df24.gif" data-src="http://habrastorage.org/getpro/habr/post_images/12f/ee3/928/12fee3928922dbe461d4bd49abc7df24.gif"/>; если еще не обращались, то просто число запросов с самого начала. Тогда время обработки <img src="http://habrastorage.org/getpro/habr/post_images/601/5f7/e7e/6015f7e7e19971bf1372e01171eaadcb.gif" data-src="http://habrastorage.org/getpro/habr/post_images/601/5f7/e7e/6015f7e7e19971bf1372e01171eaadcb.gif"/> запросов составит <img src="http://habrastorage.org/getpro/habr/post_images/65d/250/85a/65d25085aec30c33ef47e960ff608e05.gif" data-src="http://habrastorage.org/getpro/habr/post_images/65d/250/85a/65d25085aec30c33ef47e960ff608e05.gif"/>.<br/>
<br/>
Этот факт формализует мое рассуждение о кэше в начале статьи. По сути он говорит, что в среднем недавно запрошенный элемент не уплывает далеко от корня.<br/>
<br/>
<b>Сканирующая теорема</b> Последовательный доступ (LUR) к элементам <code>splay</code>-дерева выполняется за <img src="http://habrastorage.org/getpro/habr/post_images/39a/ed9/498/39aed9498a90431e37a7b32ffe2338cd.gif" data-src="http://habrastorage.org/getpro/habr/post_images/39a/ed9/498/39aed9498a90431e37a7b32ffe2338cd.gif"/>.<br/>
<br/>
Этот факт имеет большое практическое следствие. Вместе с операциями split и merge, он делает <code>splay</code>-деревья отличной основой для структуры данных <code>rope</code>. Подробнее про нее можно прочитать постах Хабра <a href="http://habrahabr.ru/post/144736/">Ropes — быстрые строки</a> и <a href="http://habrahabr.ru/post/112394/">Моноиды и их приложения...</a>.<br/>
<br/>
Спасибо за внимание! <br/>
<br/>
<h4>Литература</h4><br/>
<ul>
<li>Tarjan «Data Structures and Networks Algorithms»</li>
<li>Sleator, Daniel D.; Tarjan, Robert E. (1985), «Self-Adjusting Binary Search Trees»</li>
</ul><br/>
<br/>
<b>UPD</b>. <h4>Прагматику на заметку</h4><br/>
В комментариях есть резонный вопрос о применимости этого алгоритма на практике. Прежде чем на него ответить, я хочу заметить, что этот пост в первую очередь знакомит читателя с самим алгоритмом и его теоретическими основами. По этой причине вопросы об эффективной реализации, деталях и трюках оптимизации, коих достаточно много, я оставил за пределами статьи.<br/>
<br/>
Исследование производительности и области применения splay-деревьев оказалась темой для десятка статей. Очень оптимистичным выглядит обзор <a href="http://benpfaff.org/papers/libavl.pdf">«Performance Analysis of BSTs in System Software» Pfaff</a>, который сравнивает 20 сбалансированных деревьев с различными внутренними представлениями узлов. Тестирование производится на реальных данных для задач управления виртуальной памятью, кэшировании IP-пакетов и разрешении перекрестных ссылок. На виртуальной памяти и перекрестных ссылках splay-деревья проявили себя наилучшим образом; на IP-пакетах уступили место AVL- и красно-черным деревьям. Высокая производительность объясняется особенностью реальных данных. Подробности исследования лучше прочитать в самой статье.<br/>
<br/>
Также можно подробно ознакомиться с отчетом о производительности splay-деревьев и вопросом уменьшения числа поворотов в статье<a href="http://koti.kapsi.fi/~jukujala/papers/wea08.pdf"> «Reducing Splaying by Taking Advantage of Working Sets» Timi Aho and etc</a>. Список литературы в конце статьи содержит еще несколько отчетов о производительности.</div></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----></div> <div data-test-id="article-meta-links" class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D1%8B%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">структуры данных</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsplay-%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%5D" class="tm-tags-list__link">splay-деревья</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%5D" class="tm-tags-list__link">сбалансированные деревья</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BC%D0%BE%D1%80%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%5D" class="tm-tags-list__link">амортизационный анализ</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/JetBrains-education/blog/" class="tm-hubs-list__link router-link-active">Блог компании Образовательные проекты JetBrains</a></li><li class="tm-separated-list__item"><a href="/ru/hub/algorithms/" class="tm-hubs-list__link">Алгоритмы</a></li><li class="tm-separated-list__item"><a href="/ru/hub/maths/" class="tm-hubs-list__link">Математика</a></li></ul></div></div></article></div> <!----></div> <div data-test-id="article-sticky-panel" class="tm-article-sticky-panel"><div data-test-id="article-stats-icons" class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 88: ↑83 и ↓5</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 88: ↑83 и ↓5" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+78</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">57K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    362
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/JetBrains-education/blog/210296/comments/" data-test-id="counter-comments" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      26
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <DIV class="v-portal" style="display:none;"></DIV> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div data-test-id="article-author-info" class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/JetBrains-education/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/6f4/fce/9bc/6f4fce9bc46008c75d3b4922942730a8.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/JetBrains-education/profile/" data-test-id="company-title" class="tm-company-snippet__title">Образовательные проекты JetBrains</a> <div class="tm-company-snippet__description">Компания</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://twitter.com/JetBrainsRu" rel="noopener" target="_blank" class="tm-article-author__contact">
      Twitter
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/SeptiM/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 66 голосов " class="tm-karma tm-user-card__karma tm-karma"><div class="tm-karma__votes tm-karma__votes_positive">
    56
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter tm-rating__counter">0</div></div> <div class="tm-rating__text tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">Vsevolod Oparin</span> <a href="/ru/users/SeptiM/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @SeptiM
        </a> <!----></div> <p data-test-id="user-card-speciality" class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section>  <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div data-test-id="article-comments" data-async-called="true" class="tm-article-comments"><div class="tm-comments-wrapper"><div class="tm-comments-wrapper__wrapper"><header class="tm-comments-wrapper__header"><h2 class="tm-comments-wrapper__title">
        Комментарии
        <span class="tm-comments-wrapper__comments-count">
          26
        </span></h2> <div class="tm-comments-wrapper__header-aside"><!----> <button class="tm-rss-button tm-rss-button_comments-header"><span class="tm-svg-icon__wrapper tm-rss-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Скопировать ссылку на RSS</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#rss"></use></svg></span></button> <!----></div></header> <div class="tm-comments-wrapper__inner"> <!----> <div data-comments-list="" class="tm-comments__tree"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7340455" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7340455" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/leventov/" data-test-id="user-info-pic" title="leventov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/3d8/ed1/d4a/3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/leventov/" class="tm-user-info__username">
      leventov
    </a> <a href="#comment_7340455" class="tm-comment-thread__comment-link">
                22.02.2014 в 14:30
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">С практической точки зрения, ворочать структуру при каждом запросе — сомнительная идея.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 3: ↑2 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 3: ↑2 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7340455" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7340589" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7340589" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/" data-test-id="user-info-pic" class="tm-user-info__userpic router-link-active"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/" class="tm-user-info__username router-link-active">
      
    </a> <a href="#comment_7340589" class="tm-comment-thread__comment-link">
                22.02.2014 в 15:54
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">НЛО прилетело и опубликовало эту надпись здесь</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7340589" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7340651" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7340651" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7340651" class="tm-comment-thread__comment-link">
                22.02.2014 в 16:40
                <svg height="16" width="16" class="tm-svg-img tm-comment-thread__icon-pencil"><title>Комментарий был изменен</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#pencil-small"></use></svg></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">У каждого инструмента есть своя область применения. Splay-деревья ведут себя хорошо при последовательной обработке большого набора запросов с произвольным распределением. Они экономичны в плане количества информации, которую требуется хранить в узлах. Кроме того, splay-дерево — это сливаемая структура данных.<br/>
<br/>
С другой стороны я согласен, что постоянное изменение структуры не делает их привлекательными для параллельного или чисто-функционального программирования. Чтобы что-то получить, нужно чем-то расплатиться.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 3: ↑3 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 3: ↑3 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+3</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7340651" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7340667" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7340667" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/leventov/" data-test-id="user-info-pic" title="leventov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/3d8/ed1/d4a/3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/leventov/" class="tm-user-info__username">
      leventov
    </a> <a href="#comment_7340667" class="tm-comment-thread__comment-link">
                22.02.2014 в 16:49
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Имеет смысл добавить это в статью. Приведите примеры таких запросов. Мне кажется, это было бы полезнее, чем доказательства теор. результатов — я готов поверить на слово, что вы их не перевираете :)</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 6: ↑6 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 6: ↑6 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+6</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7340667" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341715" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-3"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341715" class="tm-comment-thread__indent_l-3"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7341715" class="tm-comment-thread__comment-link">
                23.02.2014 в 03:23
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Добавил ссылку на обзор. Splay-деревья сравнивали с красно-черными и AVL-деревьями на реальных данных. Можете посмотреть таблицы.<br/>
<br/>
Вам анализ не нужен, кому-то интересен, а у кого-то это splay-деревья с анализом — билет в экзамене.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341715" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7348909" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-4"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7348909" class="tm-comment-thread__indent_l-4"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/" data-test-id="user-info-pic" class="tm-user-info__userpic router-link-active"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/" class="tm-user-info__username router-link-active">
      
    </a> <a href="#comment_7348909" class="tm-comment-thread__comment-link">
                25.02.2014 в 09:58
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">НЛО прилетело и опубликовало эту надпись здесь</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7348909" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7351297" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-5"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7351297" class="tm-comment-thread__indent_l-5"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7351297" class="tm-comment-thread__comment-link">
                25.02.2014 в 17:29
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Провокационный вопрос: прибегут, забанят за рекламу =)<br/>
<br/>
Для школьников: ЛКШ<br/>
Для студентов: МГУ, КТ ИТМО, Академический ун-т, ШАД, CS Center. Знающие могут дополнить список.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7351297" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7353145" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-6"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7353145" class="tm-comment-thread__indent_l-6"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/" data-test-id="user-info-pic" class="tm-user-info__userpic router-link-active"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/" class="tm-user-info__username router-link-active">
      
    </a> <a href="#comment_7353145" class="tm-comment-thread__comment-link">
                26.02.2014 в 09:07
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">НЛО прилетело и опубликовало эту надпись здесь</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7353145" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7365923" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-7"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7365923" class="tm-comment-thread__indent_l-7"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/leventov/" data-test-id="user-info-pic" title="leventov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/3d8/ed1/d4a/3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/leventov/" class="tm-user-info__username">
      leventov
    </a> <a href="#comment_7365923" class="tm-comment-thread__comment-link">
                01.03.2014 в 11:24
                <svg height="16" width="16" class="tm-svg-img tm-comment-thread__icon-pencil"><title>Комментарий был изменен</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#pencil-small"></use></svg></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Я сомневаюсь, что и в перечисленных заведениях конкретно такой вопрос есть на экзамене, больно специфично. Ну, может, где-то в одном месте есть преподаватель-любитель этой структуры данных.<br/>
<br/>
А формально курс «Алгоритмы и структуры данных» с проработкой темы на различной глубине есть почти везде, где его можно ожидать.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7365923" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7366007" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-8"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7366007" class="tm-comment-thread__indent_l-8"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7366007" class="tm-comment-thread__comment-link">
                01.03.2014 в 12:09
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Программы у многих заведений открыты. Некоторые даже <a href="http://habrahabr.ru/company/yandex/blog/208716/">видеозаписи</a> выкладывают. Если Вы сомневаетесь, что лекционный материал идет на экзамен… ну, сомневайтесь.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7366007" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7366021" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-9"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7366021" class="tm-comment-thread__indent_l-9"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/leventov/" data-test-id="user-info-pic" title="leventov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/3d8/ed1/d4a/3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/leventov/" class="tm-user-info__username">
      leventov
    </a> <a href="#comment_7366021" class="tm-comment-thread__comment-link">
                01.03.2014 в 12:15
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">В Яндексе, похоже, есть, и в вашем вузе, надо понимать. У нас Бауманке такие вещи идут на экзамен без формального доказательства, только результаты, на отлично — пара вопросов «на понимание».</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7366021" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7368231" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-10"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7368231" class="tm-comment-thread__indent_l-10"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/" data-test-id="user-info-pic" class="tm-user-info__userpic router-link-active"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/" class="tm-user-info__username router-link-active">
      
    </a> <a href="#comment_7368231" class="tm-comment-thread__comment-link">
                02.03.2014 в 11:41
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">НЛО прилетело и опубликовало эту надпись здесь</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7368231" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341535" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341535" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/ilmirus/" data-test-id="user-info-pic" title="ilmirus" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/7d8/d5c/6aa/7d8d5c6aaf517605040de244b9e61744.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/ilmirus/" class="tm-user-info__username">
      ilmirus
    </a> <a href="#comment_7341535" class="tm-comment-thread__comment-link">
                23.02.2014 в 00:47
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Однако в компиляторах, например, GCC, это одна из основных структур данных. Splay-tree там используется при трансформации из AST в трех-адресный код. Пример использования: <a href="https://github.com/mirrors/gcc/blob/master/gcc/omp-low.c">github.com/mirrors/gcc/blob/master/gcc/omp-low.c</a></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341535" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341665" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341665" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Gumanoid/" data-test-id="user-info-pic" title="Gumanoid" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/f6c/b8d/c34/f6cb8dc347664edbf542d9b085481ee4.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Gumanoid/" class="tm-user-info__username">
      Gumanoid
    </a> <a href="#comment_7341665" class="tm-comment-thread__comment-link">
                23.02.2014 в 02:24
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Привет от коллег по бранчу gomp-4_0-branch :)</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341665" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341523" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341523" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Cher/" data-test-id="user-info-pic" title="Cher" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/9da/dbf/3be/9dadbf3bea9addad8325ab253d6939f8.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Cher/" class="tm-user-info__username">
      Cher
    </a> <a href="#comment_7341523" class="tm-comment-thread__comment-link">
                23.02.2014 в 00:39
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">статья в лучших и всего 4 комментария. Верный признак того что написанно умно но никто ничего не понял )</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 7: ↑6 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 7: ↑6 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+5</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341523" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341537" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341537" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/amarao/" data-test-id="user-info-pic" title="amarao" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/a4d/28c/40e/a4d28c40e664ad1a3632a3c0a2ca1c72.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/amarao/" class="tm-user-info__username">
      amarao
    </a> <a href="#comment_7341537" class="tm-comment-thread__comment-link">
                23.02.2014 в 00:47
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Меня всегда беспокоят алгоритмы, в которых о константах думают свысока. Например, запись в ответ на запрос чтения — это же ужасно. Особенно, если это несколько записей. <br/>
<br/>
На практике пренебрежение константами превращается в ужасающего едва ворочающегося монстра, у которого o(logn), но такие константы, что до времён, когда логарифм становится важным, просто не доходят.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341537" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7341573" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7341573" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7341573" class="tm-comment-thread__comment-link">
                23.02.2014 в 01:08
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">В теории есть алгоритм Левина, который решает любую задачу за асимптотически оптимальное время. Он перебирает все возможные программы и запускает их параллельно. Но константа там большая, да…<br/>
<br/>
По поводу практической части. Да, действительно, каждый раз делать splay — это печально. Начиная с 2000 люди предложили несколько эвристик, которые позволяют оптимизировать работу splay-дерева. Кое-каких результатов на практике добились. Я видимо напишу заметку-дополнение как ответ этому комментарию и одному выше, что хорошего здесь происходило.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7341573" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7347011" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7347011" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/nickolaym/" data-test-id="user-info-pic" title="nickolaym" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/getpro/habr/avatars/f70/00c/aa0/f7000caa0393fed31bfb6add0f5e8aa0.gif" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/nickolaym/" class="tm-user-info__username">
      nickolaym
    </a> <a href="#comment_7347011" class="tm-comment-thread__comment-link">
                24.02.2014 в 20:47
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Можно пояснить следующие моменты?<br/>
<br/>
1. Если у нас есть априорные частоты запросов; в принципе, мы сразу можем построить ДДП с оптимальной глубиной.<br/>
2. Апостериорные частоты, т.е. мы набираем статистику по ходу обращений к дереву, заодно и вращаем его, оптимизируя под текущее распределение.<br/>
3. Скользящая статистика. Предполагается, что история запросов постепенно теряет актуальность.<br/>
<br/>
В первом случае мы можем отсортировать ключи по возрастанию/убыванию веса (в зависимости от того, как будем строить дерево: добавлять листья или наращивать корень), построим обычное несбалансированное ДДП — его вид будет соответствовать коду Фано.<br/>
А если постараться, то и код Хаффмана так же делается.<br/>
Splay tree здесь, как видно, не при чём.<br/>
<br/>
В третьем случае, — если придерживаться политики MRU (most recently used), вытаскивать свежезапрошенный ключ на самый верх и затем пусть он тонет, — размер окна истории не поддаётся контролю, а если правильно подобрать запросы, то дерево выродится в линейный список, и в нужный момент мы выстрелим, запросив самый хвостик.<br/>
Или splay tree защищено от таких выстрелов, и какую-то минимальную сбалансированность гарантирует?<br/>
<br/>
Во втором случае нам или нужна таблица частот (счётчики обращений) для каждого ключа, или у нас не честное MFU (most frequently used), а всё то же MRU.<br/>
Или мы закладываемся на то, что при «хороших» последовательностях запросов политики MFU и MRU должны давать близкие результаты?<br/>
</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7347011" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7347931" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7347931" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7347931" class="tm-comment-thread__comment-link">
                25.02.2014 в 00:57
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Можно. =)<br/>
<br/>
1. Если все известно заранее, то splay дерево не нужно. Мне кажется, что решение должно быть каким-то таким. Берем ключ такой, что сумма частот слева и справа от него меньше половины. Делаем его корнем. Строим поддеревья рекурсивно. С точностью до константы, это дерево точно будет оптимальным.<br/>
<br/>
Хаффман, если что, меняет порядок ключей. Так что его технику использовать напрямую не получится.<br/>
<br/>
2 (и 3). Мне пока не очень понятно, как именно у вас происходит балансировка. Кроме того, статистика — это доп. информация, которую надо хранить. В AVL, красно-черных деревьях достаточно одного-двух битов доп. информации, в splay — нуля.<br/>
<br/>
3. Нет, от тяжелых запросов деревья не защищены. В некоторых случаях делают splay через раз, или подбрасывают монетку, делать ли splay. Но вообще, такое может случиться. Если нужны быстрые ответы на единичные запросы, лучше использовать другие деревья: AVL, B, красно-черные.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7347931" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7348287" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7348287" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/nickolaym/" data-test-id="user-info-pic" title="nickolaym" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/getpro/habr/avatars/f70/00c/aa0/f7000caa0393fed31bfb6add0f5e8aa0.gif" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/nickolaym/" class="tm-user-info__username">
      nickolaym
    </a> <a href="#comment_7348287" class="tm-comment-thread__comment-link">
                25.02.2014 в 03:24
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Если правильно распорядиться Хаффманом, то порядок ключей не изменится.<br/>
Единственная сложность в том, что при равномерном распределении все ключи должны были бы находиться на одинаковой глубине, а в ДДП в любом случае корневой ключ имеет преимущество.<br/>
Как это представить в коде Хаффмана, я ещё не придумал, но истина где-то рядом.<br/>
Итак, схема примерно такая.<br/>
1) строим код Хаффмана в соответствии с частотами<br/>
2) <u>забываем про нолики и единички</u>, нас интересует только длина кодов<br/>
3) располагаем ключи по порядку<br/>
4) рисуем над ними дерево, так, что каждый ключ оказывается на той глубине, которая соответствует длине его кода<br/>
</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7348287" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7351257" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-3"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7351257" class="tm-comment-thread__indent_l-3"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7351257" class="tm-comment-thread__comment-link">
                25.02.2014 в 17:19
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Я думаю, Вам надо провести практическое исследование. Нагенерируйте разные последовательности запросов, возьмите что-то из реальной жизни и протестируйте это на разных деревьях, в том числе, придуманных Вами. Потом можете рассказать, что у Вас получилось в отдельном посте на Хабре.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7351257" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7348335" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7348335" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/nickolaym/" data-test-id="user-info-pic" title="nickolaym" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/getpro/habr/avatars/f70/00c/aa0/f7000caa0393fed31bfb6add0f5e8aa0.gif" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/nickolaym/" class="tm-user-info__username">
      nickolaym
    </a> <a href="#comment_7348335" class="tm-comment-thread__comment-link">
                25.02.2014 в 03:47
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Про балансировку. Вот мне как раз и непонятно.<br/>
Процедура splay вытягивает найденный узел наверх, то есть, фактически, мы ведём MRU-список.<br/>
(А бомба выглядит очень просто, кстати. Опросим все ключи в порядке возрастания, а потом опросим самый первый ключ).<br/>
<br/>
Если бы каждый узел хранил счётчик обращений, то мы могли бы поступать более интеллектуально: поднимать обновлённые узлы над своими (пока ещё) менее вероятными соседями, а не до самого корня.<br/>
Тем самым получим адаптивный код Фано. До кода Хаффмана не дотянемся, да и бог с ним.<br/>
<br/>
Чтобы деградировать историю, — проще всего прибегнуть к экспоненциальному скользящему среднему.<br/>
Тут вес узла — это не сумма обращений за всю историю, а взвешенная сумма с коэффициентами. убывающими по экспоненциальному закону. Т.е. если касались в моменты T=1, 5, 7, а сейчас момент T=10, то вес будет a^(10-7) + a^(10-5) + a^(10-1) где 0&lt;a&lt;1.<br/>
Считать ЭСС очень удобно, потому что в каждый момент времени достаточно обновлять вес по закону W(t) = W(t-1)*a + dW.<br/>
Решение в лоб потребовало бы пересчитывать вес всех узлов дерева, но, чтобы избежать это, проще приписать каждому узлу его вес и момент последнего обновления.<br/>
Тогда пересчёт веса будет выглядеть так: W(t) = W(t-t0)*a^(t-t0) + dW<br/>
где dW = 1, если узел «был найден» и = 0, если это соседний узел, с которым мы решаем — проворачивать дерево или нет.<br/>
То есть, в узле, помимо ключа, хранится целое число (номер отсчёта) и вещественное (вес на тот момент).<br/>
<br/>
Но это всё «чистые математические» подходы.<br/>
Если принять меры против вырождения splay-деревьев (случайное перетряхивание или отслеживание дисбаланса, как в AVL), то выгода от простоты структуры принесёт ощутимые плоды.<br/>
Чем меньше возни и чем меньше памяти, тем быстрее, — даже если количество итераций будет больше (в пределах логарифма).</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7348335" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7348347" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7348347" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/nickolaym/" data-test-id="user-info-pic" title="nickolaym" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/getpro/habr/avatars/f70/00c/aa0/f7000caa0393fed31bfb6add0f5e8aa0.gif" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/nickolaym/" class="tm-user-info__username">
      nickolaym
    </a> <a href="#comment_7348347" class="tm-comment-thread__comment-link">
                25.02.2014 в 03:55
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Ну и последнее, что хотел сказать: обычное дерево — не cache friendly.<br/>
Априорный частотный анализ позволил бы разместить наиболее популярные ключи (первые ярусы дерева) в одной странице.<br/>
Апостериорный — MRU или MFU, — ясное дело, потребует перемещения ключей, а это дорогое удовольствие.<br/>
<br/>
Если дерево по-настоящему большое, и мы хотим выжать все оптимизационные соки из него, то лучше, всё-таки, взять априорную статистику и выстроить структуру по-хаффмановски, а в памяти расположить по-ярусно. Да и вообще подумать в сторону Б-деревьев.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7348347" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7360573" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7360573" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/TechThink/" data-test-id="user-info-pic" title="TechThink" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/TechThink/" class="tm-user-info__username">
      TechThink
    </a> <a href="#comment_7360573" class="tm-comment-thread__comment-link">
                27.02.2014 в 21:48
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">def find(v, key):<br/>
 if v == None:<br/>
 return None<br/>
 if key == v.key:<br/>
 return splay(v)<br/>
 if key &lt; v.key and v.left != None:<br/>
 return find(v.left, key)<br/>
 if key > v.key and v.right != None:<br/>
 return find(v.right, key)<br/>
 return splay(v)<br/>
<br/>
Завершающий функцию return гарантирует, что если поиск неудачен, то последняя просмотренная вершина будет «выдернута» наверх. Это зачем такое?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7360573" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7360809" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7360809" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/SeptiM/" data-test-id="user-info-pic" title="SeptiM" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/SeptiM/" class="tm-user-info__username">
      SeptiM
    </a> <a href="#comment_7360809" class="tm-comment-thread__comment-link">
                27.02.2014 в 23:04
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Представьте, что в какой-то момент дерево выстроилось в односвязный список. Ключ с наименьшим значением в самом низу. Пусть все запросы спрашивают условно минус бесконечность. Без splay-а каждый запрос будет обрабатываться за линейное время. А так, мы выдергиваем один из ближайших элементов наверх и в следующий раз нам не придется лезть глубоко.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7360809" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7360859" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7360859" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/TechThink/" data-test-id="user-info-pic" title="TechThink" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/TechThink/" class="tm-user-info__username">
      TechThink
    </a> <a href="#comment_7360859" class="tm-comment-thread__comment-link">
                27.02.2014 в 23:22
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Разумно. Спасибо!</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7360859" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section></div>  <DIV class="v-portal" style="display:none;"></DIV></div></div> <div class="tm-notice tm-comments__comment-notice tm-notice_positive"><!----> <div class="tm-notice__inner"><!----> <div data-test-id="notice-content" class="tm-notice__content"><span>Только полноправные пользователи могут оставлять комментарии. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/company/JetBrains-education/blog/210296/&hl=ru">Войдите</a>, пожалуйста.</span></div></div></div></div></div></div></div>  <!----> <div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----></div> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title">Информация</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2000-01-31T21:00:00.000Z" title="2000-02-01, 00:00">1  февраля  2000</time></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://www.jetbrains.com/" target="_blank" class="tm-company-basic-info__link">
      www.jetbrains.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    501–1 000 человек
  </dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2014-02-25T09:07:40.000Z" title="2014-02-25, 13:07">25  февраля  2014</time></dd></dl> <!----></div></div> <!----></section> <!----> <!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/JetBrains-education/blog/210296/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/JetBrains-education/blog/210296/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2022, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"210296":{"id":"210296","timePublished":"2014-02-22T08:38:33+00:00","isCorporative":true,"lang":"ru","titleHtml":"Splay-деревья","leadData":{"textHtml":"Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других сбалансированных деревьев. Но является ли перманентная сбалансированность тем Святым Граалем, за которым следует гоняться?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредставим, что мы уже построили дерево на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fc7f\u002F092\u002Fd48\u002Fc7f092d481acb49c8a0f96178ceb3119.gif\"\u002F\u003E ключах и теперь нам нужно отвечать на запросы, лежит ли заданный ключ в дереве. Может так оказаться, что пользователя интересует в основном один ключ, и остальные он запрашивает только время от времени. Если ключ лежит далеко от корня, то \u003Cimg src=\"https:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fm\"\u002F\u003E запросов могут отнять \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F076\u002F63d\u002Fc3c\u002F07663dc3c790b8c5e111597f71b68abc.gif\"\u002F\u003E времени. Здравый смысл подсказывает, что оценку можно оптимизировать до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7be\u002F274\u002F948\u002F7be27494810106e7a26b615c21f37527.gif\"\u002F\u003E, надстроив над деревом кэш. Но этот подход имеет некоторый недостаток гибкости и элегантности.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСегодня я расскажу о splay-деревьях. Эти деревья не являются перманентно сбалансированными и на отдельных запросах могут работать даже линейное время. Однако, после каждого запроса они меняют свою структуру, что позволяет очень эффективно обрабатывать часто повторяющиеся запросы. Более того, амортизационная стоимость обработки одного запроса у них \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F84c\u002F07b\u002Fcc9\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\"\u002F\u003E, что делает splay-деревья хорошей альтернативой для перманентно сбалансированных собратьев.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше...","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null,"scoreStats":{"score":56,"votesCount":66},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":26,"favoritesCount":362,"readingCount":56863,"score":78,"votesCount":88},"hubs":[{"id":"18875","alias":"JetBrains-education","type":"corporative","title":"Блог компании Образовательные проекты JetBrains","titleHtml":"Блог компании Образовательные проекты JetBrains","isProfiled":false,"relatedData":null},{"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true,"relatedData":null},{"id":"17812","alias":"maths","type":"collective","title":"Математика","titleHtml":"Математика","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других сбалансированных деревьев. Но является ли перманентная сбалансированность тем Святым Граалем, за которым следует гоняться?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредставим, что мы уже построили дерево на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fc7f\u002F092\u002Fd48\u002Fc7f092d481acb49c8a0f96178ceb3119.gif\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fc7f\u002F092\u002Fd48\u002Fc7f092d481acb49c8a0f96178ceb3119.gif\"\u002F\u003E ключах и теперь нам нужно отвечать на запросы, лежит ли заданный ключ в дереве. Может так оказаться, что пользователя интересует в основном один ключ, и остальные он запрашивает только время от времени. Если ключ лежит далеко от корня, то \u003Cimg src=\"https:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fm\"\u002F\u003E запросов могут отнять \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F076\u002F63d\u002Fc3c\u002F07663dc3c790b8c5e111597f71b68abc.gif\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F076\u002F63d\u002Fc3c\u002F07663dc3c790b8c5e111597f71b68abc.gif\"\u002F\u003E времени. Здравый смысл подсказывает, что оценку можно оптимизировать до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7be\u002F274\u002F948\u002F7be27494810106e7a26b615c21f37527.gif\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7be\u002F274\u002F948\u002F7be27494810106e7a26b615c21f37527.gif\"\u002F\u003E, надстроив над деревом кэш. Но этот подход имеет некоторый недостаток гибкости и элегантности.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСегодня я расскажу о splay-деревьях. Эти деревья не являются перманентно сбалансированными и на отдельных запросах могут работать даже линейное время. Однако, после каждого запроса они меняют свою структуру, что позволяет очень эффективно обрабатывать часто повторяющиеся запросы. Более того, амортизационная стоимость обработки одного запроса у них \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F84c\u002F07b\u002Fcc9\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F84c\u002F07b\u002Fcc9\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\"\u002F\u003E, что делает splay-деревья хорошей альтернативой для перманентно сбалансированных собратьев.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003ESplay-деревья\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ середине восьмидесятых Роберт Тарьян и Даниель Слейтор предложили несколько красивых и эффективных структур данных. Все они имеют несложную базовую структуру и одну-две эвристики, которые их постоянно локально подправляют. Splay-дерево — одна из таких структур.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nSplay-дерево — это самобалансирующееся бинарное дерево поиска. Дереву не нужно хранить никакой дополнительной информации, что делает его эффективным по памяти. После каждого обращения, даже поиска, splay-дерево меняет свою структуру. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНиже я опишу алгоритм, как работает дерево на наборе попарно различных ключей, а потом приведу его анализ. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EАлгоритм\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nДля описания структуры дерева нам пригодится простенький класс, описывающий отдельную вершину,\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eclass Node:\n  def __init__(self, key, left = None, right = None, parent = None):\n    self.left   = left\n    self.right  = right\n    self.parent = parent\n    self.key    = key\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nи две вспомогательные процедуры для работы с указателями на родителей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef set_parent(child, parent):\n  if child != None:\n    child.parent = parent\n\ndef keep_parent(v):\n  set_parent(v.left, v)\n  set_parent(v.right, v)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nОсновная эвристика splay-дерева — move-to-root. После обращения к любой вершине, она поднимается в корень. Подъем реализуется через повороты вершин. За один поворот, можно поменять местами родителя с ребенком, как показано на рисунке ниже.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F58b\u002F97d\u002Fc8b\u002F58b97dc8bf8293538e48a34716f4e1f5.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F58b\u002F97d\u002Fc8b\u002F58b97dc8bf8293538e48a34716f4e1f5.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef rotate(parent, child):\n  gparent = parent.parent\n  if gparent != None:\n    if gparent.left == parent:\n      gparent.left = child\n    else:\n      gparent.right = child\n\n  if parent.left == child:\n    parent.left, child.right = child.right, parent\n  else:\n    parent.right, child.left = child.left, parent\n\n  keep_parent(child)\n  keep_parent(parent)\n  child.parent = gparent\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nНо просто поворачивать вершину, пока она не станет корнем, недостаточно. Хитрость splay-дерева в том, что при продвижении вершины вверх, расстояние до корня сокращается не только для поднимаемой вершины, но и для всех ее потомков в текущих поддеревьях. Для этого используется техника zig-zig и zig-zag поворотов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОсновная идея zig-zig и zig-zag поворотов, рассмотреть путь от дедушки к ребенку. Если путь идет только по левым детям или только по правым, то такая ситуация называется zig-zig. Как ее обрабатывать показано на рисунке ниже. Сначала повернуть родителя, потом ребенка.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F13c\u002F2ec\u002F397\u002F13c2ec39790be792f792fe393db53be5.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F13c\u002F2ec\u002F397\u002F13c2ec39790be792f792fe393db53be5.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ противном случае, мы сначала меняем ребенка с текущим родителем, потом с новым.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fccf\u002F9f3\u002Ff52\u002Fccf9f3f52fea0caa23df9070d4833bc3.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fccf\u002F9f3\u002Ff52\u002Fccf9f3f52fea0caa23df9070d4833bc3.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли у вершины дедушки нет, делаем обычный поворот:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F36e\u002F527\u002F090\u002F36e527090c0e49bf48ba45d20fb780f7.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F36e\u002F527\u002F090\u002F36e527090c0e49bf48ba45d20fb780f7.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОписанная выше процедура поднятия вершины с помощью zig-zig и zig-zag поворотов является ключевой для splay-дерева.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EПримечание\u003C\u002Fb\u003E. В русском языке термин «splay» перевели как «расширять». Мне кажется, это не очень удачный перевод. Вы берете вершину и тянете ее наверх. В это время все другие вершины уходят вниз, поворачиваясь вокруг нее. Нечто похожее происходит, когда вы выворачиваете футболку. Так что слово «выворачивать» кажется здесь более подходящим.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef splay(v):\n  if v.parent == None:\n    return v\n  parent = v.parent\n  gparent = parent.parent\n  if gparent == None:\n    rotate(parent, v) \n    return v    \n  else:\n    zigzig = (gparent.left == parent) == (parent.left == v)\n    if zigzig:\n      rotate(gparent, parent)\n      rotate(parent, v)\n    else:\n      rotate(parent, v)\n      rotate(gparent, v)\n    return splay(v)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nПроцедура поиска в splay-дереве отличается от обычной только на последней стадии: после того, как вершина найдена, мы тянем ее вверх и делаем корнем через процедуру \u003Ccode\u003Esplay\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef find(v, key):\n  if v == None:\n    return None\n  if key == v.key:\n    return splay(v)\n  if key &lt; v.key and v.left != None:\n    return find(v.left, key)\n  if key \u003E v.key and v.right != None:\n    return find(v.right, key)\n  return splay(v)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nЧтобы реализовать вставку и удаление ключа, нам потребуются две процедуры: \u003Ccode\u003Esplit\u003C\u002Fcode\u003E и \u003Ccode\u003Emerge\u003C\u002Fcode\u003E (разрезать и слить). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПроцедура \u003Ccode\u003Esplit\u003C\u002Fcode\u003E получает на вход ключ \u003Ccode\u003Ekey\u003C\u002Fcode\u003E и делит дерево на два. В одном дереве все значения меньше ключа \u003Ccode\u003Ekey\u003C\u002Fcode\u003E, а в другом — больше. Реализуется она просто. Нужно через \u003Ccode\u003Efind\u003C\u002Fcode\u003E найти ближайшую к ключу вершину, вытянуть ее вверх и потом отрезать либо левое, либо правое поддерево (либо оба).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef split(root, key):\n  if root == None:\n    return None, None\n  root = find(root, key)\n  if root.key == key:\n    set_parent(root.left, None)\n    set_parent(root.right, None)\n    return root.left, root.right\n  if root.key &lt; key:\n    right, root.right = root.right, None\n    set_parent(right, None)\n    return root, right\n  else:\n    left, root.left = root.left, None\n    set_parent(left, None)\n    return left, root \n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nЧтобы вставить очередной ключ, достаточно вызвать \u003Ccode\u003Esplit\u003C\u002Fcode\u003E по нему, а затем сделать новую вершину-корень, у которой поддеревьями будет результат \u003Ccode\u003Esplit\u003C\u002Fcode\u003E-а.\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef insert(root, key):\n  left, right = split(root, key)\n  root = Node(key, left, right)\n  keep_parent(root)\n  return root\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nПроцедура \u003Ccode\u003Emerge\u003C\u002Fcode\u003E получает на вход два дерева: левое \u003Ccode\u003Eleft\u003C\u002Fcode\u003E и правое \u003Ccode\u003Eright\u003C\u002Fcode\u003E. Для корректной работы, ключи дерева \u003Ccode\u003Eleft\u003C\u002Fcode\u003E должны быть меньше ключей дерева \u003Ccode\u003Eright\u003C\u002Fcode\u003E. Здесь мы берем вершину с наименьшим ключом правого дерева \u003Ccode\u003Eright\u003C\u002Fcode\u003E и тянем ее вверх. После этого в качестве левого поддерева присоединяем дерево \u003Ccode\u003Eleft\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef merge(left, right):\n  if right == None:\n    return left\n  if left == None:\n    return right\n  right = find(right, left.key)\n  right.left, left.parent = left, right\n  return right\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nДля того, чтобы удалить вершину, нужно поднять ее вверх, а потом слить ее левые и правые поддеревья.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef remove(root, key):\n  root = find(root, key)\n  set_parent(root.left, None)\n  set_parent(root.right, None)\n  return merge(root.left, root.right)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nЧтобы splay-дерево поддерживало повторяющиеся ключи, можно поступить двумя способами. Нужно либо каждому ключу сопоставить список, хранящий нужную доп. информацию, либо реализовать процедуру find так, чтобы она возвращала первую в порядке обхода LUR вершину с ключом, большим либо равным заданного.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EАнализ\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nЗаметим, что процедуры удаления, вставки, слияния и разделения деревьев работают за \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fec7\u002F176\u002Fecf\u002Fec7176ecffb2f187d5ef0d0d24ffdbd4.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fec7\u002F176\u002Fecf\u002Fec7176ecffb2f187d5ef0d0d24ffdbd4.gif\"\u002F\u003E + время работы процедуры \u003Ccode\u003Efind\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПроцедура \u003Ccode\u003Efind\u003C\u002Fcode\u003E работает пропорционально глубине искомой вершины в дереве. По завершении поиска запускается процедура \u003Ccode\u003Esplay\u003C\u002Fcode\u003E, которая тоже работает пропорционально глубине вершины. Таким образом, достаточно оценить время работы процедуры \u003Ccode\u003Esplay\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля анализа воспользуемся методом физика, про который я рассказывал в статье про \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F208624\"\u003Eамортизационный анализ\u003C\u002Fa\u003E. Пусть \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F2c4\u002F55f\u002F6c3\u002F2c455f6c331507d8415d138c126d5cd1.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F2c4\u002F55f\u002F6c3\u002F2c455f6c331507d8415d138c126d5cd1.gif\"\u002F\u003E — размер поддерева \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F801\u002Fe91\u002F678\u002F801e916781182638bdd30f434f6dd79f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F801\u002Fe91\u002F678\u002F801e916781182638bdd30f434f6dd79f.gif\"\u002F\u003E с корнем в вершине \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E. Рангом вершины \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E назовем величину \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F2a4\u002Fa15\u002F263\u002F2a4a15263185920396d9b74a66fda10e.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F2a4\u002Fa15\u002F263\u002F2a4a15263185920396d9b74a66fda10e.gif\"\u002F\u003E. Наш потенциал будет \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F01e\u002Ffed\u002Fdbf\u002F01efeddbf29cf53eddad0eb121c3865c.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F01e\u002Ffed\u002Fdbf\u002F01efeddbf29cf53eddad0eb121c3865c.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБудем считать, что фактическое время процедуры \u003Ccode\u003Esplay(v)\u003C\u002Fcode\u003E равно глубине \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fh\"\u002F\u003E вершины \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E. Отметим, что это также равно числу элементарных поворотов, которые будут выполнены в ходе процедуры.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EУтверждение\u003C\u002Fb\u003E. Амортизационная стоимость операции \u003Ccode\u003Esplay\u003C\u002Fcode\u003E от вершины \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E в дереве \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fb94\u002F550\u002F354\u002Fb94550354872977b0f0aad8cda86789e.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fb94\u002F550\u002F354\u002Fb94550354872977b0f0aad8cda86789e.gif\"\u002F\u003E с корнем \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fr\"\u002F\u003E составляет \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fbac\u002F598\u002F191\u002Fbac5981912a4b3785f398a37163010ec.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fbac\u002F598\u002F191\u002Fbac5981912a4b3785f398a37163010ec.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EДоказательство\u003C\u002Fb\u003E. \u003Cbr\u002F\u003E\r\nЕсли \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E — корень, то утверждение очевидно. В противном случае разделим процедуру \u003Ccode\u003Esplay(v)\u003C\u002Fcode\u003E на этапы. В ходе каждого этапа выполняется один из трех поворотов: zig, zig-zig или zig-zag. На простой поворот уходит единица времени, на zig-zig и zig-zag — две единицы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле каждого этапа ранг вершины \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E будет меняться. Пусть изначально ранг составляет \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fbd2\u002Fe8c\u002F4de\u002Fbd2e8c4deee380873258074067f47a79.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fbd2\u002Fe8c\u002F4de\u002Fbd2e8c4deee380873258074067f47a79.gif\"\u002F\u003E, а после \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fi\"\u002F\u003E-ого этапа — \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F45a\u002F141\u002F2de\u002F45a1412deeddf95d0291a61419916399.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F45a\u002F141\u002F2de\u002F45a1412deeddf95d0291a61419916399.gif\"\u002F\u003E. Для каждого этапа, кроме, быть может, последнего, мы покажем, что амортизационное время на его выполнение можно ограничить сверху величиной \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F514\u002F7e6\u002F520\u002F5147e652057fc82f5cc918ad29f95543.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F514\u002F7e6\u002F520\u002F5147e652057fc82f5cc918ad29f95543.gif\"\u002F\u003E. Для последнего этапа верхняя оценка составит \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3a7\u002Fc5a\u002Fd43\u002F3a7c5ad43334e60bfd005218c4a6cf67.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3a7\u002Fc5a\u002Fd43\u002F3a7c5ad43334e60bfd005218c4a6cf67.gif\"\u002F\u003E. Просуммировав верхние оценки и сократив промежуточные значения рангов мы получим требуемое\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F72d\u002F3e4\u002F837\u002F72d3e4837c9cbdce557c78e41a136e51.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F72d\u002F3e4\u002F837\u002F72d3e4837c9cbdce557c78e41a136e51.gif\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНужно только заметить, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3d4\u002F903\u002Fc4a\u002F3d4903c4a6ab562fa149407b12cbdd95.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3d4\u002F903\u002Fc4a\u002F3d4903c4a6ab562fa149407b12cbdd95.gif\"\u002F\u003E, а \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa10\u002F2e6\u002F672\u002Fa102e6672264a72c4d01f4c1ef352345.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa10\u002F2e6\u002F672\u002Fa102e6672264a72c4d01f4c1ef352345.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь разберем каждый тип поворота отдельно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nZig. Может выполняться только один раз, на последнем этапе. Фактическое время \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F26f\u002Fff1\u002F377\u002F26fff1377fd5ee7a18d590a322203e05.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F26f\u002Fff1\u002F377\u002F26fff1377fd5ee7a18d590a322203e05.gif\"\u002F\u003E. Посмотрим на рисунок и поймем, что ранги меняются только у вершин \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fv\"\u002F\u003E и \u003Cimg src=\"http:\u002F\u002Ftex.s2cms.ru\u002Fsvg\u002Fr\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Ffiles\u002Fbd9\u002Fd53\u002F7e5\u002Fbd9d537e58a24dfb94445b704a903153.png\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Ffiles\u002Fbd9\u002Fd53\u002F7e5\u002Fbd9d537e58a24dfb94445b704a903153.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗначит, амортизационная стоимость составит \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe61\u002F061\u002Fe90\u002Fe61061e90cf933cf6ec28f8d25e905d7.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe61\u002F061\u002Fe90\u002Fe61061e90cf933cf6ec28f8d25e905d7.gif\"\u002F\u003E. Ранги \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\"\u002F\u003E и \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fad2\u002Fd15\u002Fa8d\u002Fad2d15a8df39e0b455d90f44a350d356.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fad2\u002Fd15\u002Fa8d\u002Fad2d15a8df39e0b455d90f44a350d356.gif\"\u002F\u003E сокращаются. Исходя из размеров соответствующих поддеревьев применим к формуле \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\"\u002F\u003E неравенство:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F0ca\u002F37d\u002F0b1\u002F0ca37d0b18e353c266d5b324d89a156f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F0ca\u002F37d\u002F0b1\u002F0ca37d0b18e353c266d5b324d89a156f.gif\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗначит, \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe8e\u002Faea\u002F72f\u002Fe8eaea72f1417fc4e5e0d7a0cc887ef1.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe8e\u002Faea\u002F72f\u002Fe8eaea72f1417fc4e5e0d7a0cc887ef1.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nZig-zig. Фактическое время \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F95c\u002F007\u002F330\u002F95c0073302d8e83f0658373bf031d628.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F95c\u002F007\u002F330\u002F95c0073302d8e83f0658373bf031d628.gif\"\u002F\u003E. Заметим, что ранги меняются только у вершин \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F778\u002F167\u002Fba0\u002F778167ba0bfe8d797c1444241533f806.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F778\u002F167\u002Fba0\u002F778167ba0bfe8d797c1444241533f806.gif\"\u002F\u003E, \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4f9\u002Fca1\u002Fb1c\u002F4f9ca1b1c8029535c88032fbe0b24b60.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4f9\u002Fca1\u002Fb1c\u002F4f9ca1b1c8029535c88032fbe0b24b60.gif\"\u002F\u003E и \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Ffiles\u002F566\u002F742\u002F2e5\u002F5667422e5f6a4b17b1936349921a2a62.png\" data-src=\"\u002F\u002Fhabrastorage.org\u002Ffiles\u002F566\u002F742\u002F2e5\u002F5667422e5f6a4b17b1936349921a2a62.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТогда амортизационная стоимость \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff88\u002F07b\u002Ff37\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff88\u002F07b\u002Ff37\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\"\u002F\u003E. Ранги \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\"\u002F\u003E и \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\"\u002F\u003E можно сократить. Получим, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F9e6\u002Ff72\u002Fcc4\u002F9e6f72cc4496cad479eee6dfb081b61c.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F9e6\u002Ff72\u002Fcc4\u002F9e6f72cc4496cad479eee6dfb081b61c.gif\"\u002F\u003E. Исходя из размеров поддеревьев применим к формуле \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\"\u002F\u003E два неравенства:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F008\u002F61a\u002Ff75\u002F00861af757b1c0f16fdd2a82525d278e.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F008\u002F61a\u002Ff75\u002F00861af757b1c0f16fdd2a82525d278e.gif\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nи получим, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe75\u002F31c\u002Ff9f\u002Fe7531cf9f42d16323412064c7f4f5fe6.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe75\u002F31c\u002Ff9f\u002Fe7531cf9f42d16323412064c7f4f5fe6.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНаша цель — показать, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fd52\u002F059\u002F7a0\u002Fd520597a0b03a29b8c707e8c848c0c3c.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fd52\u002F059\u002F7a0\u002Fd520597a0b03a29b8c707e8c848c0c3c.gif\"\u002F\u003E. Для этого достаточно показать, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fda2\u002F0bd\u002F041\u002Fda20bd0413ddd7abb2c6a1124a70ed1f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fda2\u002F0bd\u002F041\u002Fda20bd0413ddd7abb2c6a1124a70ed1f.gif\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F385\u002F49c\u002F6e6\u002F38549c6e67f5913b05c03db9e23f0966.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F385\u002F49c\u002F6e6\u002F38549c6e67f5913b05c03db9e23f0966.gif\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля удобства перенесем ранги в левую часть и будем доказывать \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8d1\u002Fbe0\u002F29f\u002F8d1be029f449db8442cfb9b5e81cd7f6.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8d1\u002Fbe0\u002F29f\u002F8d1be029f449db8442cfb9b5e81cd7f6.gif\"\u002F\u003E. По определению ранга \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fab1\u002Fb92\u002Fdcc\u002Fab1b92dcc990d3ac0f39df4e4ece7ec0.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fab1\u002Fb92\u002Fdcc\u002Fab1b92dcc990d3ac0f39df4e4ece7ec0.gif\"\u002F\u003E. Последнее равенство разобъем на сумму \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F269\u002F10c\u002F32f\u002F26910c32f49a0473c0bf8b9aea4d6158.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F269\u002F10c\u002F32f\u002F26910c32f49a0473c0bf8b9aea4d6158.gif\"\u002F\u003E. Посмотрим на рисунок и поймем, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff8f\u002Fdbd\u002Fa6d\u002Ff8fdbda6d98e4b55cef1518928558774.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff8f\u002Fdbd\u002Fa6d\u002Ff8fdbda6d98e4b55cef1518928558774.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EФакт\u003C\u002Fb\u003E. \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcb8\u002Fe8e\u002Fc07\u002Fcb8e8ec07a4a7872b6acaf707d6e673f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcb8\u002Fe8e\u002Fc07\u002Fcb8e8ec07a4a7872b6acaf707d6e673f.gif\"\u002F\u003E для любых положительных \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fc80\u002Fd13\u002Fd58\u002Fc80d13d587a00fca58b429e785e3c06a.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fc80\u002Fd13\u002Fd58\u002Fc80d13d587a00fca58b429e785e3c06a.gif\"\u002F\u003E таких, что \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F76b\u002F3b1\u002Fea4\u002F76b3b1ea4f0c87f8fc93e7f66faf333b.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F76b\u002F3b1\u002Fea4\u002F76b3b1ea4f0c87f8fc93e7f66faf333b.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\nЗначит, \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa93\u002F276\u002Ff12\u002Fa93276f12dd9474eb7fef7a83748cebf.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa93\u002F276\u002Ff12\u002Fa93276f12dd9474eb7fef7a83748cebf.gif\"\u002F\u003E. Получили требуемое.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nZig-zag. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Ffiles\u002Ffd0\u002Fb05\u002F323\u002Ffd0b0532300a4e98b6089883319524c8.png\" data-src=\"\u002F\u002Fhabrastorage.org\u002Ffiles\u002Ffd0\u002Fb05\u002F323\u002Ffd0b0532300a4e98b6089883319524c8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nАналогично предыдущему случаю запишем амортизационную оценку: \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff88\u002F07b\u002Ff37\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff88\u002F07b\u002Ff37\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРанги \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F155\u002Fbde\u002F9f5\u002F155bde9f50a1332adbefa9c833ae068f.gif\"\u002F\u003E и \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8ca\u002Febe\u002F078\u002F8caebe078b8f5a33590e85caea5439cd.gif\"\u002F\u003E сокращаются. К формуле \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F270\u002Fcbb\u002Fbb6\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\"\u002F\u003E применим следующие неравенства:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F0c5\u002F232\u002F69d\u002F0c523269dbad8d147f278380b9d4cb76.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F0c5\u002F232\u002F69d\u002F0c523269dbad8d147f278380b9d4cb76.gif\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗначит, \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F11e\u002F019\u002F6f0\u002F11e0196f041a65b9712d2128d106eeaf.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F11e\u002F019\u002F6f0\u002F11e0196f041a65b9712d2128d106eeaf.gif\"\u002F\u003E. Это неравенство доказывается аналогично предыдущему случаю.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаким образом мы разобрали все три случая и получили верхнюю оценку на амортизированное время через ранги. \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa8e\u002Fbdf\u002F07e\u002Fa8ebdf07e1219a23c6f51afadcf2d768.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa8e\u002Fbdf\u002F07e\u002Fa8ebdf07e1219a23c6f51afadcf2d768.gif\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОсталось заметить, что ранг любой вершины ограничен логарифмом размера дерева. Из чего следует следующая теорема.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EТеорема\u003C\u002Fb\u003E. Операция \u003Ccode\u003Esplay\u003C\u002Fcode\u003E амортизационно выполняется за \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F84c\u002F07b\u002Fcc9\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F84c\u002F07b\u002Fcc9\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EДругие метрики и свойства\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nНа десерт я хотел бы сослаться на \u003Ca href=\"http:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSplay_tree\"\u003Eвикипедию\u003C\u002Fa\u003E и представить здесь несколько интересных фактов про \u003Ccode\u003Esplay\u003C\u002Fcode\u003E-деревья.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EТеорема о статической оптимальности\u003C\u002Fb\u003E. Пусть \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcad\u002F4e8\u002Ff95\u002Fcad4e8f9585700a0a979e4d098851bb4.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcad\u002F4e8\u002Ff95\u002Fcad4e8f9585700a0a979e4d098851bb4.gif\"\u002F\u003E — число раз, которое был запрошен элемент \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F882\u002F839\u002Ffd0\u002F882839fd0d8c0796ef0f881d89ac3705.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F882\u002F839\u002Ffd0\u002F882839fd0d8c0796ef0f881d89ac3705.gif\"\u002F\u003E. Тогда выполнение \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F601\u002F5f7\u002Fe7e\u002F6015f7e7e19971bf1372e01171eaadcb.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F601\u002F5f7\u002Fe7e\u002F6015f7e7e19971bf1372e01171eaadcb.gif\"\u002F\u003E запросов поиска на \u003Ccode\u003Esplay\u003C\u002Fcode\u003E-дереве выполняется за \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4e4\u002Fafc\u002F38a\u002F4e4afc38a83dfc386be50875ee0dd12f.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4e4\u002Fafc\u002F38a\u002F4e4afc38a83dfc386be50875ee0dd12f.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПо сути этот факт сообщает следующее. Пусть мы заранее знаем, в каком количестве будут заданы запросы для различных элементов. Мы строим какое-то конкретное бинарное дерево, чтобы отвечать на эти запросы как можно быстрее. Утверждение сообщает, что с точностью до константы \u003Ccode\u003Esplay\u003C\u002Fcode\u003E-дерево будет амортизационно работать не хуже, чем самое оптимальное фиксированное дерево, которое мы можем придумать. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EТеорема о текущем множестве\u003C\u002Fb\u003E. Пусть \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F41c\u002F9fd\u002F590\u002F41c9fd5903fa785884a1325457399279.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F41c\u002F9fd\u002F590\u002F41c9fd5903fa785884a1325457399279.gif\"\u002F\u003E — это число запросов, которое мы уже совершили с момента последнего запроса к элементу \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F12f\u002Fee3\u002F928\u002F12fee3928922dbe461d4bd49abc7df24.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F12f\u002Fee3\u002F928\u002F12fee3928922dbe461d4bd49abc7df24.gif\"\u002F\u003E; если еще не обращались, то просто число запросов с самого начала. Тогда время обработки \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F601\u002F5f7\u002Fe7e\u002F6015f7e7e19971bf1372e01171eaadcb.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F601\u002F5f7\u002Fe7e\u002F6015f7e7e19971bf1372e01171eaadcb.gif\"\u002F\u003E запросов составит \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F65d\u002F250\u002F85a\u002F65d25085aec30c33ef47e960ff608e05.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F65d\u002F250\u002F85a\u002F65d25085aec30c33ef47e960ff608e05.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭтот факт формализует мое рассуждение о кэше в начале статьи. По сути он говорит, что в среднем недавно запрошенный элемент не уплывает далеко от корня.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EСканирующая теорема\u003C\u002Fb\u003E Последовательный доступ (LUR) к элементам \u003Ccode\u003Esplay\u003C\u002Fcode\u003E-дерева выполняется за \u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F39a\u002Fed9\u002F498\u002F39aed9498a90431e37a7b32ffe2338cd.gif\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F39a\u002Fed9\u002F498\u002F39aed9498a90431e37a7b32ffe2338cd.gif\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭтот факт имеет большое практическое следствие. Вместе с операциями split и merge, он делает \u003Ccode\u003Esplay\u003C\u002Fcode\u003E-деревья отличной основой для структуры данных \u003Ccode\u003Erope\u003C\u002Fcode\u003E. Подробнее про нее можно прочитать постах Хабра \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F144736\u002F\"\u003ERopes — быстрые строки\u003C\u002Fa\u003E и \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F112394\u002F\"\u003EМоноиды и их приложения...\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСпасибо за внимание! \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЛитература\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003ETarjan «Data Structures and Networks Algorithms»\u003C\u002Fli\u003E\r\n\u003Cli\u003ESleator, Daniel D.; Tarjan, Robert E. (1985), «Self-Adjusting Binary Search Trees»\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EUPD\u003C\u002Fb\u003E. \u003Ch4\u003EПрагматику на заметку\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ комментариях есть резонный вопрос о применимости этого алгоритма на практике. Прежде чем на него ответить, я хочу заметить, что этот пост в первую очередь знакомит читателя с самим алгоритмом и его теоретическими основами. По этой причине вопросы об эффективной реализации, деталях и трюках оптимизации, коих достаточно много, я оставил за пределами статьи.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИсследование производительности и области применения splay-деревьев оказалась темой для десятка статей. Очень оптимистичным выглядит обзор \u003Ca href=\"http:\u002F\u002Fbenpfaff.org\u002Fpapers\u002Flibavl.pdf\"\u003E«Performance Analysis of BSTs in System Software» Pfaff\u003C\u002Fa\u003E, который сравнивает 20 сбалансированных деревьев с различными внутренними представлениями узлов. Тестирование производится на реальных данных для задач управления виртуальной памятью, кэшировании IP-пакетов и разрешении перекрестных ссылок. На виртуальной памяти и перекрестных ссылках splay-деревья проявили себя наилучшим образом; на IP-пакетах уступили место AVL- и красно-черным деревьям. Высокая производительность объясняется особенностью реальных данных. Подробности исследования лучше прочитать в самой статье.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТакже можно подробно ознакомиться с отчетом о производительности splay-деревьев и вопросом уменьшения числа поворотов в статье\u003Ca href=\"http:\u002F\u002Fkoti.kapsi.fi\u002F~jukujala\u002Fpapers\u002Fwea08.pdf\"\u003E «Reducing Splaying by Taking Advantage of Working Sets» Timi Aho and etc\u003C\u002Fa\u003E. Список литературы в конце статьи содержит еще несколько отчетов о производительности.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"структуры данных"},{"titleHtml":"splay-деревья"},{"titleHtml":"сбалансированные деревья"},{"titleHtml":"амортизационный анализ"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F210296\u002F707c775ac60e40a686ac792b0e702b3a\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F210296\u002F707c775ac60e40a686ac792b0e702b3a\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002FJetBrains-education\\\u002Fblog\\\u002F210296\\\u002F\"},\"headline\":\"Splay-деревья\",\"datePublished\":\"2014-02-22T12:38:33+04:00\",\"dateModified\":\"2016-06-02T13:43:50+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Vsevolod Oparin\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, A...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002FJetBrains-education\\\u002Fblog\\\u002F210296\\\u002F#post-content-body\",\"about\":[\"c_JetBrains-education\",\"h_algorithms\",\"h_maths\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fc7f\\\u002F092\\\u002Fd48\\\u002Fc7f092d481acb49c8a0f96178ceb3119.gif\",\"https:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fm\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F076\\\u002F63d\\\u002Fc3c\\\u002F07663dc3c790b8c5e111597f71b68abc.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F7be\\\u002F274\\\u002F948\\\u002F7be27494810106e7a26b615c21f37527.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F84c\\\u002F07b\\\u002Fcc9\\\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F58b\\\u002F97d\\\u002Fc8b\\\u002F58b97dc8bf8293538e48a34716f4e1f5.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F13c\\\u002F2ec\\\u002F397\\\u002F13c2ec39790be792f792fe393db53be5.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fccf\\\u002F9f3\\\u002Ff52\\\u002Fccf9f3f52fea0caa23df9070d4833bc3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F36e\\\u002F527\\\u002F090\\\u002F36e527090c0e49bf48ba45d20fb780f7.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fec7\\\u002F176\\\u002Fecf\\\u002Fec7176ecffb2f187d5ef0d0d24ffdbd4.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F2c4\\\u002F55f\\\u002F6c3\\\u002F2c455f6c331507d8415d138c126d5cd1.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F801\\\u002Fe91\\\u002F678\\\u002F801e916781182638bdd30f434f6dd79f.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F2a4\\\u002Fa15\\\u002F263\\\u002F2a4a15263185920396d9b74a66fda10e.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F01e\\\u002Ffed\\\u002Fdbf\\\u002F01efeddbf29cf53eddad0eb121c3865c.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fh\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fb94\\\u002F550\\\u002F354\\\u002Fb94550354872977b0f0aad8cda86789e.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fr\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fbac\\\u002F598\\\u002F191\\\u002Fbac5981912a4b3785f398a37163010ec.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fbd2\\\u002Fe8c\\\u002F4de\\\u002Fbd2e8c4deee380873258074067f47a79.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fi\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F45a\\\u002F141\\\u002F2de\\\u002F45a1412deeddf95d0291a61419916399.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F514\\\u002F7e6\\\u002F520\\\u002F5147e652057fc82f5cc918ad29f95543.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3a7\\\u002Fc5a\\\u002Fd43\\\u002F3a7c5ad43334e60bfd005218c4a6cf67.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F72d\\\u002F3e4\\\u002F837\\\u002F72d3e4837c9cbdce557c78e41a136e51.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3d4\\\u002F903\\\u002Fc4a\\\u002F3d4903c4a6ab562fa149407b12cbdd95.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fa10\\\u002F2e6\\\u002F672\\\u002Fa102e6672264a72c4d01f4c1ef352345.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F26f\\\u002Fff1\\\u002F377\\\u002F26fff1377fd5ee7a18d590a322203e05.gif\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fv\",\"http:\\\u002F\\\u002Ftex.s2cms.ru\\\u002Fsvg\\\u002Fr\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Ffiles\\\u002Fbd9\\\u002Fd53\\\u002F7e5\\\u002Fbd9d537e58a24dfb94445b704a903153.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fe61\\\u002F061\\\u002Fe90\\\u002Fe61061e90cf933cf6ec28f8d25e905d7.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F155\\\u002Fbde\\\u002F9f5\\\u002F155bde9f50a1332adbefa9c833ae068f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fad2\\\u002Fd15\\\u002Fa8d\\\u002Fad2d15a8df39e0b455d90f44a350d356.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F270\\\u002Fcbb\\\u002Fbb6\\\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F0ca\\\u002F37d\\\u002F0b1\\\u002F0ca37d0b18e353c266d5b324d89a156f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fe8e\\\u002Faea\\\u002F72f\\\u002Fe8eaea72f1417fc4e5e0d7a0cc887ef1.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F95c\\\u002F007\\\u002F330\\\u002F95c0073302d8e83f0658373bf031d628.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F778\\\u002F167\\\u002Fba0\\\u002F778167ba0bfe8d797c1444241533f806.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F4f9\\\u002Fca1\\\u002Fb1c\\\u002F4f9ca1b1c8029535c88032fbe0b24b60.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8ca\\\u002Febe\\\u002F078\\\u002F8caebe078b8f5a33590e85caea5439cd.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Ffiles\\\u002F566\\\u002F742\\\u002F2e5\\\u002F5667422e5f6a4b17b1936349921a2a62.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff88\\\u002F07b\\\u002Ff37\\\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F155\\\u002Fbde\\\u002F9f5\\\u002F155bde9f50a1332adbefa9c833ae068f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8ca\\\u002Febe\\\u002F078\\\u002F8caebe078b8f5a33590e85caea5439cd.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F9e6\\\u002Ff72\\\u002Fcc4\\\u002F9e6f72cc4496cad479eee6dfb081b61c.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F270\\\u002Fcbb\\\u002Fbb6\\\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F008\\\u002F61a\\\u002Ff75\\\u002F00861af757b1c0f16fdd2a82525d278e.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fe75\\\u002F31c\\\u002Ff9f\\\u002Fe7531cf9f42d16323412064c7f4f5fe6.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fd52\\\u002F059\\\u002F7a0\\\u002Fd520597a0b03a29b8c707e8c848c0c3c.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fda2\\\u002F0bd\\\u002F041\\\u002Fda20bd0413ddd7abb2c6a1124a70ed1f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F385\\\u002F49c\\\u002F6e6\\\u002F38549c6e67f5913b05c03db9e23f0966.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8d1\\\u002Fbe0\\\u002F29f\\\u002F8d1be029f449db8442cfb9b5e81cd7f6.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fab1\\\u002Fb92\\\u002Fdcc\\\u002Fab1b92dcc990d3ac0f39df4e4ece7ec0.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F269\\\u002F10c\\\u002F32f\\\u002F26910c32f49a0473c0bf8b9aea4d6158.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff8f\\\u002Fdbd\\\u002Fa6d\\\u002Ff8fdbda6d98e4b55cef1518928558774.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fcb8\\\u002Fe8e\\\u002Fc07\\\u002Fcb8e8ec07a4a7872b6acaf707d6e673f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fc80\\\u002Fd13\\\u002Fd58\\\u002Fc80d13d587a00fca58b429e785e3c06a.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F76b\\\u002F3b1\\\u002Fea4\\\u002F76b3b1ea4f0c87f8fc93e7f66faf333b.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fa93\\\u002F276\\\u002Ff12\\\u002Fa93276f12dd9474eb7fef7a83748cebf.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Ffiles\\\u002Ffd0\\\u002Fb05\\\u002F323\\\u002Ffd0b0532300a4e98b6089883319524c8.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff88\\\u002F07b\\\u002Ff37\\\u002Ff8807bf37fe6b7b3233fef522b691a4a.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F155\\\u002Fbde\\\u002F9f5\\\u002F155bde9f50a1332adbefa9c833ae068f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8ca\\\u002Febe\\\u002F078\\\u002F8caebe078b8f5a33590e85caea5439cd.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F270\\\u002Fcbb\\\u002Fbb6\\\u002F270cbbbb6cb0b4c0634e86f443bd3ab6.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F0c5\\\u002F232\\\u002F69d\\\u002F0c523269dbad8d147f278380b9d4cb76.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F11e\\\u002F019\\\u002F6f0\\\u002F11e0196f041a65b9712d2128d106eeaf.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fa8e\\\u002Fbdf\\\u002F07e\\\u002Fa8ebdf07e1219a23c6f51afadcf2d768.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F84c\\\u002F07b\\\u002Fcc9\\\u002F84c07bcc99d5fc8ab9086ace521ed96a.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fcad\\\u002F4e8\\\u002Ff95\\\u002Fcad4e8f9585700a0a979e4d098851bb4.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F882\\\u002F839\\\u002Ffd0\\\u002F882839fd0d8c0796ef0f881d89ac3705.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F601\\\u002F5f7\\\u002Fe7e\\\u002F6015f7e7e19971bf1372e01171eaadcb.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F4e4\\\u002Fafc\\\u002F38a\\\u002F4e4afc38a83dfc386be50875ee0dd12f.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F41c\\\u002F9fd\\\u002F590\\\u002F41c9fd5903fa785884a1325457399279.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F12f\\\u002Fee3\\\u002F928\\\u002F12fee3928922dbe461d4bd49abc7df24.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F601\\\u002F5f7\\\u002Fe7e\\\u002F6015f7e7e19971bf1372e01171eaadcb.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F65d\\\u002F250\\\u002F85a\\\u002F65d25085aec30c33ef47e960ff608e05.gif\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F39a\\\u002Fed9\\\u002F498\\\u002F39aed9498a90431e37a7b32ffe2338cd.gif\"]}","metaDescription":"Сбалансированное дерево поиска является фундаментом для многих современных алгоритмов. На страницах книг по Computer Science вы найдете описания красно-черных, AVL-, B- и многих других...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":["535316","210296","267855","342674","69424","267037","120343","559518","408055","351092"],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{"210296":{"refs":{"7340455":{"id":"7340455","parentId":null,"level":0,"timePublished":"2014-02-22T10:30:00+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":3,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EС практической точки зрения, ворочать структуру при каждом запросе — сомнительная идея.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60470","alias":"leventov","fullname":"Роман Левентов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3d8\u002Fed1\u002Fd4a\u002F3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg","speciality":"Systems engineer and thinker"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7340589","7340651","7341535"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7340589":{"id":"7340589","parentId":"7340455","level":1,"timePublished":"2014-02-22T11:54:45+00:00","timeChanged":null,"isSuspended":false,"status":"author_blocked","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНЛО прилетело и опубликовало эту надпись здесь\u003C\u002Fdiv\u003E","editorVersion":0,"author":{},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7340651":{"id":"7340651","parentId":"7340455","level":1,"timePublished":"2014-02-22T12:40:40+00:00","timeChanged":"2014-02-22T12:41:40+00:00","isSuspended":false,"status":"published","score":3,"votesCount":3,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EУ каждого инструмента есть своя область применения. Splay-деревья ведут себя хорошо при последовательной обработке большого набора запросов с произвольным распределением. Они экономичны в плане количества информации, которую требуется хранить в узлах. Кроме того, splay-дерево — это сливаемая структура данных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nС другой стороны я согласен, что постоянное изменение структуры не делает их привлекательными для параллельного или чисто-функционального программирования. Чтобы что-то получить, нужно чем-то расплатиться.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7340667"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7340667":{"id":"7340667","parentId":"7340651","level":2,"timePublished":"2014-02-22T12:49:23+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":6,"votesCount":6,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EИмеет смысл добавить это в статью. Приведите примеры таких запросов. Мне кажется, это было бы полезнее, чем доказательства теор. результатов — я готов поверить на слово, что вы их не перевираете :)\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60470","alias":"leventov","fullname":"Роман Левентов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3d8\u002Fed1\u002Fd4a\u002F3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg","speciality":"Systems engineer and thinker"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7341715"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341523":{"id":"7341523","parentId":null,"level":0,"timePublished":"2014-02-22T20:39:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":5,"votesCount":7,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003Eстатья в лучших и всего 4 комментария. Верный признак того что написанно умно но никто ничего не понял )\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"9645","alias":"Cher","fullname":"Cher","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F9da\u002Fdbf\u002F3be\u002F9dadbf3bea9addad8325ab253d6939f8.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341535":{"id":"7341535","parentId":"7340455","level":1,"timePublished":"2014-02-22T20:47:54+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EОднако в компиляторах, например, GCC, это одна из основных структур данных. Splay-tree там используется при трансформации из AST в трех-адресный код. Пример использования: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fmirrors\u002Fgcc\u002Fblob\u002Fmaster\u002Fgcc\u002Fomp-low.c\"\u003Egithub.com\u002Fmirrors\u002Fgcc\u002Fblob\u002Fmaster\u002Fgcc\u002Fomp-low.c\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"79596","alias":"ilmirus","fullname":"Ильмир Усманов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F7d8\u002Fd5c\u002F6aa\u002F7d8d5c6aaf517605040de244b9e61744.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7341665"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341537":{"id":"7341537","parentId":null,"level":0,"timePublished":"2014-02-22T20:47:59+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМеня всегда беспокоят алгоритмы, в которых о константах думают свысока. Например, запись в ответ на запрос чтения — это же ужасно. Особенно, если это несколько записей. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа практике пренебрежение константами превращается в ужасающего едва ворочающегося монстра, у которого o(logn), но такие константы, что до времён, когда логарифм становится важным, просто не доходят.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"55867","alias":"amarao","fullname":"Георгий Шуклин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa4d\u002F28c\u002F40e\u002Fa4d28c40e664ad1a3632a3c0a2ca1c72.png","speciality":"оператор ЭВМ"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7341573"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341573":{"id":"7341573","parentId":"7341537","level":1,"timePublished":"2014-02-22T21:08:36+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ теории есть алгоритм Левина, который решает любую задачу за асимптотически оптимальное время. Он перебирает все возможные программы и запускает их параллельно. Но константа там большая, да…\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПо поводу практической части. Да, действительно, каждый раз делать splay — это печально. Начиная с 2000 люди предложили несколько эвристик, которые позволяют оптимизировать работу splay-дерева. Кое-каких результатов на практике добились. Я видимо напишу заметку-дополнение как ответ этому комментарию и одному выше, что хорошего здесь происходило.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341665":{"id":"7341665","parentId":"7341535","level":2,"timePublished":"2014-02-22T22:24:30+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПривет от коллег по бранчу gomp-4_0-branch :)\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"13336","alias":"Gumanoid","fullname":"Gum","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff6c\u002Fb8d\u002Fc34\u002Ff6cb8dc347664edbf542d9b085481ee4.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7341715":{"id":"7341715","parentId":"7340667","level":3,"timePublished":"2014-02-22T23:23:23+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EДобавил ссылку на обзор. Splay-деревья сравнивали с красно-черными и AVL-деревьями на реальных данных. Можете посмотреть таблицы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВам анализ не нужен, кому-то интересен, а у кого-то это splay-деревья с анализом — билет в экзамене.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7348909"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7347011":{"id":"7347011","parentId":null,"level":0,"timePublished":"2014-02-24T16:47:42+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМожно пояснить следующие моменты?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1. Если у нас есть априорные частоты запросов; в принципе, мы сразу можем построить ДДП с оптимальной глубиной.\u003Cbr\u002F\u003E\r\n2. Апостериорные частоты, т.е. мы набираем статистику по ходу обращений к дереву, заодно и вращаем его, оптимизируя под текущее распределение.\u003Cbr\u002F\u003E\r\n3. Скользящая статистика. Предполагается, что история запросов постепенно теряет актуальность.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ первом случае мы можем отсортировать ключи по возрастанию\u002Fубыванию веса (в зависимости от того, как будем строить дерево: добавлять листья или наращивать корень), построим обычное несбалансированное ДДП — его вид будет соответствовать коду Фано.\u003Cbr\u002F\u003E\r\nА если постараться, то и код Хаффмана так же делается.\u003Cbr\u002F\u003E\r\nSplay tree здесь, как видно, не при чём.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ третьем случае, — если придерживаться политики MRU (most recently used), вытаскивать свежезапрошенный ключ на самый верх и затем пусть он тонет, — размер окна истории не поддаётся контролю, а если правильно подобрать запросы, то дерево выродится в линейный список, и в нужный момент мы выстрелим, запросив самый хвостик.\u003Cbr\u002F\u003E\r\nИли splay tree защищено от таких выстрелов, и какую-то минимальную сбалансированность гарантирует?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВо втором случае нам или нужна таблица частот (счётчики обращений) для каждого ключа, или у нас не честное MFU (most frequently used), а всё то же MRU.\u003Cbr\u002F\u003E\r\nИли мы закладываемся на то, что при «хороших» последовательностях запросов политики MFU и MRU должны давать близкие результаты?\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"164649","alias":"nickolaym","fullname":"Николай Меркин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff70\u002F00c\u002Faa0\u002Ff7000caa0393fed31bfb6add0f5e8aa0.gif","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7347931"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7347931":{"id":"7347931","parentId":"7347011","level":1,"timePublished":"2014-02-24T20:57:17+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМожно. =)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1. Если все известно заранее, то splay дерево не нужно. Мне кажется, что решение должно быть каким-то таким. Берем ключ такой, что сумма частот слева и справа от него меньше половины. Делаем его корнем. Строим поддеревья рекурсивно. С точностью до константы, это дерево точно будет оптимальным.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХаффман, если что, меняет порядок ключей. Так что его технику использовать напрямую не получится.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2 (и 3). Мне пока не очень понятно, как именно у вас происходит балансировка. Кроме того, статистика — это доп. информация, которую надо хранить. В AVL, красно-черных деревьях достаточно одного-двух битов доп. информации, в splay — нуля.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3. Нет, от тяжелых запросов деревья не защищены. В некоторых случаях делают splay через раз, или подбрасывают монетку, делать ли splay. Но вообще, такое может случиться. Если нужны быстрые ответы на единичные запросы, лучше использовать другие деревья: AVL, B, красно-черные.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7348287","7348335","7348347"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7348287":{"id":"7348287","parentId":"7347931","level":2,"timePublished":"2014-02-24T23:24:08+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЕсли правильно распорядиться Хаффманом, то порядок ключей не изменится.\u003Cbr\u002F\u003E\r\nЕдинственная сложность в том, что при равномерном распределении все ключи должны были бы находиться на одинаковой глубине, а в ДДП в любом случае корневой ключ имеет преимущество.\u003Cbr\u002F\u003E\r\nКак это представить в коде Хаффмана, я ещё не придумал, но истина где-то рядом.\u003Cbr\u002F\u003E\r\nИтак, схема примерно такая.\u003Cbr\u002F\u003E\r\n1) строим код Хаффмана в соответствии с частотами\u003Cbr\u002F\u003E\r\n2) \u003Cu\u003Eзабываем про нолики и единички\u003C\u002Fu\u003E, нас интересует только длина кодов\u003Cbr\u002F\u003E\r\n3) располагаем ключи по порядку\u003Cbr\u002F\u003E\r\n4) рисуем над ними дерево, так, что каждый ключ оказывается на той глубине, которая соответствует длине его кода\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"164649","alias":"nickolaym","fullname":"Николай Меркин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff70\u002F00c\u002Faa0\u002Ff7000caa0393fed31bfb6add0f5e8aa0.gif","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7351257"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7348335":{"id":"7348335","parentId":"7347931","level":2,"timePublished":"2014-02-24T23:47:47+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПро балансировку. Вот мне как раз и непонятно.\u003Cbr\u002F\u003E\r\nПроцедура splay вытягивает найденный узел наверх, то есть, фактически, мы ведём MRU-список.\u003Cbr\u002F\u003E\r\n(А бомба выглядит очень просто, кстати. Опросим все ключи в порядке возрастания, а потом опросим самый первый ключ).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли бы каждый узел хранил счётчик обращений, то мы могли бы поступать более интеллектуально: поднимать обновлённые узлы над своими (пока ещё) менее вероятными соседями, а не до самого корня.\u003Cbr\u002F\u003E\r\nТем самым получим адаптивный код Фано. До кода Хаффмана не дотянемся, да и бог с ним.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы деградировать историю, — проще всего прибегнуть к экспоненциальному скользящему среднему.\u003Cbr\u002F\u003E\r\nТут вес узла — это не сумма обращений за всю историю, а взвешенная сумма с коэффициентами. убывающими по экспоненциальному закону. Т.е. если касались в моменты T=1, 5, 7, а сейчас момент T=10, то вес будет a^(10-7) + a^(10-5) + a^(10-1) где 0&lt;a&lt;1.\u003Cbr\u002F\u003E\r\nСчитать ЭСС очень удобно, потому что в каждый момент времени достаточно обновлять вес по закону W(t) = W(t-1)*a + dW.\u003Cbr\u002F\u003E\r\nРешение в лоб потребовало бы пересчитывать вес всех узлов дерева, но, чтобы избежать это, проще приписать каждому узлу его вес и момент последнего обновления.\u003Cbr\u002F\u003E\r\nТогда пересчёт веса будет выглядеть так: W(t) = W(t-t0)*a^(t-t0) + dW\u003Cbr\u002F\u003E\r\nгде dW = 1, если узел «был найден» и = 0, если это соседний узел, с которым мы решаем — проворачивать дерево или нет.\u003Cbr\u002F\u003E\r\nТо есть, в узле, помимо ключа, хранится целое число (номер отсчёта) и вещественное (вес на тот момент).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо это всё «чистые математические» подходы.\u003Cbr\u002F\u003E\r\nЕсли принять меры против вырождения splay-деревьев (случайное перетряхивание или отслеживание дисбаланса, как в AVL), то выгода от простоты структуры принесёт ощутимые плоды.\u003Cbr\u002F\u003E\r\nЧем меньше возни и чем меньше памяти, тем быстрее, — даже если количество итераций будет больше (в пределах логарифма).\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"164649","alias":"nickolaym","fullname":"Николай Меркин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff70\u002F00c\u002Faa0\u002Ff7000caa0393fed31bfb6add0f5e8aa0.gif","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7348347":{"id":"7348347","parentId":"7347931","level":2,"timePublished":"2014-02-24T23:55:25+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНу и последнее, что хотел сказать: обычное дерево — не cache friendly.\u003Cbr\u002F\u003E\r\nАприорный частотный анализ позволил бы разместить наиболее популярные ключи (первые ярусы дерева) в одной странице.\u003Cbr\u002F\u003E\r\nАпостериорный — MRU или MFU, — ясное дело, потребует перемещения ключей, а это дорогое удовольствие.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли дерево по-настоящему большое, и мы хотим выжать все оптимизационные соки из него, то лучше, всё-таки, взять априорную статистику и выстроить структуру по-хаффмановски, а в памяти расположить по-ярусно. Да и вообще подумать в сторону Б-деревьев.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"164649","alias":"nickolaym","fullname":"Николай Меркин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff70\u002F00c\u002Faa0\u002Ff7000caa0393fed31bfb6add0f5e8aa0.gif","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7348909":{"id":"7348909","parentId":"7341715","level":4,"timePublished":"2014-02-25T05:58:51+00:00","timeChanged":null,"isSuspended":false,"status":"author_blocked","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНЛО прилетело и опубликовало эту надпись здесь\u003C\u002Fdiv\u003E","editorVersion":0,"author":{},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7351297"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7351257":{"id":"7351257","parentId":"7348287","level":3,"timePublished":"2014-02-25T13:19:45+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЯ думаю, Вам надо провести практическое исследование. Нагенерируйте разные последовательности запросов, возьмите что-то из реальной жизни и протестируйте это на разных деревьях, в том числе, придуманных Вами. Потом можете рассказать, что у Вас получилось в отдельном посте на Хабре.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7351297":{"id":"7351297","parentId":"7348909","level":5,"timePublished":"2014-02-25T13:29:00+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПровокационный вопрос: прибегут, забанят за рекламу =)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля школьников: ЛКШ\u003Cbr\u002F\u003E\r\nДля студентов: МГУ, КТ ИТМО, Академический ун-т, ШАД, CS Center. Знающие могут дополнить список.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7353145"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7353145":{"id":"7353145","parentId":"7351297","level":6,"timePublished":"2014-02-26T05:07:33+00:00","timeChanged":null,"isSuspended":false,"status":"author_blocked","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНЛО прилетело и опубликовало эту надпись здесь\u003C\u002Fdiv\u003E","editorVersion":0,"author":{},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7365923"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7360573":{"id":"7360573","parentId":null,"level":0,"timePublished":"2014-02-27T17:48:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003Edef find(v, key):\u003Cbr\u002F\u003E\r\n if v == None:\u003Cbr\u002F\u003E\r\n return None\u003Cbr\u002F\u003E\r\n if key == v.key:\u003Cbr\u002F\u003E\r\n return splay(v)\u003Cbr\u002F\u003E\r\n if key &lt; v.key and v.left != None:\u003Cbr\u002F\u003E\r\n return find(v.left, key)\u003Cbr\u002F\u003E\r\n if key \u003E v.key and v.right != None:\u003Cbr\u002F\u003E\r\n return find(v.right, key)\u003Cbr\u002F\u003E\r\n return splay(v)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗавершающий функцию return гарантирует, что если поиск неудачен, то последняя просмотренная вершина будет «выдернута» наверх. Это зачем такое?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"127900","alias":"TechThink","fullname":"Андрей Неволин","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7360809"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7360809":{"id":"7360809","parentId":"7360573","level":1,"timePublished":"2014-02-27T19:04:22+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПредставьте, что в какой-то момент дерево выстроилось в односвязный список. Ключ с наименьшим значением в самом низу. Пусть все запросы спрашивают условно минус бесконечность. Без splay-а каждый запрос будет обрабатываться за линейное время. А так, мы выдергиваем один из ближайших элементов наверх и в следующий раз нам не придется лезть глубоко.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7360859"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7360859":{"id":"7360859","parentId":"7360809","level":2,"timePublished":"2014-02-27T19:22:42+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EРазумно. Спасибо!\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"127900","alias":"TechThink","fullname":"Андрей Неволин","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7365923":{"id":"7365923","parentId":"7353145","level":7,"timePublished":"2014-03-01T07:24:43+00:00","timeChanged":"2014-03-01T07:26:51+00:00","isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЯ сомневаюсь, что и в перечисленных заведениях конкретно такой вопрос есть на экзамене, больно специфично. Ну, может, где-то в одном месте есть преподаватель-любитель этой структуры данных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА формально курс «Алгоритмы и структуры данных» с проработкой темы на различной глубине есть почти везде, где его можно ожидать.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60470","alias":"leventov","fullname":"Роман Левентов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3d8\u002Fed1\u002Fd4a\u002F3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg","speciality":"Systems engineer and thinker"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7366007"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7366007":{"id":"7366007","parentId":"7365923","level":8,"timePublished":"2014-03-01T08:09:50+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПрограммы у многих заведений открыты. Некоторые даже \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fyandex\u002Fblog\u002F208716\u002F\"\u003Eвидеозаписи\u003C\u002Fa\u003E выкладывают. Если Вы сомневаетесь, что лекционный материал идет на экзамен… ну, сомневайтесь.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"50984","alias":"SeptiM","fullname":"Vsevolod Oparin","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7366021"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7366021":{"id":"7366021","parentId":"7366007","level":9,"timePublished":"2014-03-01T08:15:23+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ Яндексе, похоже, есть, и в вашем вузе, надо понимать. У нас Бауманке такие вещи идут на экзамен без формального доказательства, только результаты, на отлично — пара вопросов «на понимание».\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60470","alias":"leventov","fullname":"Роман Левентов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3d8\u002Fed1\u002Fd4a\u002F3d8ed1d4aabbb2ccb1ebb363b7e2c927.jpg","speciality":"Systems engineer and thinker"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["7368231"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7368231":{"id":"7368231","parentId":"7366021","level":10,"timePublished":"2014-03-02T07:41:07+00:00","timeChanged":null,"isSuspended":false,"status":"author_blocked","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНЛО прилетело и опубликовало эту надпись здесь\u003C\u002Fdiv\u003E","editorVersion":0,"author":{},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false}},"root":["7340455","7341523","7341537","7347011","7360573"]}},"articlePinnedComments":{"210296":{"refs":{},"commentIds":[]}},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{"isCanComment":false,"cantCommentReasonKey":"AUTH_REQUIRED","cantCommentReason":"Authorization required","data":null},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":1393746067,"moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"jetbrains-education":{"alias":"JetBrains-education","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F6f4\u002Ffce\u002F9bc\u002F6f4fce9bc46008c75d3b4922942730a8.png","titleHtml":"Образовательные проекты JetBrains","descriptionHtml":null,"relatedData":null,"statistics":{"subscribersCount":1486,"rating":0,"invest":null,"postsCount":167,"newsCount":9,"vacanciesCount":0,"employeesCount":18,"careerRating":null},"foundationDate":{"year":"2000","month":"02","day":"01"},"location":{"city":{"id":"447733","title":"Санкт-Петербург"},"region":{"id":"1948","title":"Санкт-Петербург и область"},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fwww.jetbrains.com\u002F","staffNumber":"501–1 000 человек","registrationDate":"2014-02-25T09:07:40+00:00","representativeUser":null,"contacts":[{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002FJetBrainsRu","siteTitle":null,"favicon":null}],"settings":{"analyticsSettings":[],"branding":null,"status":"expired","isStartup":false},"metadata":{"titleHtml":"Образовательные проекты JetBrains, Санкт-Петербург -  с 1 февраля 2000 г.","title":"Образовательные проекты JetBrains, Санкт-Петербург -  с 1 февраля 2000 г.","keywords":["Учебный процесс в IT","Алгоритмы","Математика","Статистика в IT","Управление продуктом","образование","программирование","алгоритмы","магистратура","математика","cs центр","jetbrains","computer science","биоинформатика","анализ данных","software engineering","машинное обучение","jetbrains research","онлайн-курсы","теоретическая информатика","учебный процесс","образование в it","академический университет","информатика","c++"],"descriptionHtml":"167 статей от авторов компании Образовательные проекты JetBrains","description":"167 статей от авторов компании Образовательные проекты JetBrains"},"aDeskSettings":null,"careerAlias":null}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"technotext":{"nominationsList":[]},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.a3ff8f09.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.344a2afd.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
