<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>Ropes — быстрые строки / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.76652d4b.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.a3ff8f09.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.9cdf9b0e.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.344a2afd.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.76652d4b.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.9cdf9b0e.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.6aa513a2e8a86335c6bf81d4cfd55980.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/144736\/"},"headline":"Ropes — быстрые строки","datePublished":"2012-05-29T11:59:07+04:00","dateModified":"2012-05-29T14:17:30+04:00","author":{"@type":"Person","name":"Flux"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать &mdash; если ты пишешь код, ты обречен каждый день складывать строки, разбив...","url":"https:\/\/habr.com\/ru\/post\/144736\/#post-content-body","about":["h_algorithms","f_develop"],"image":["http:\/\/habrastorage.org\/storage2\/568\/80a\/c96\/56880ac966d7cd11be5a704edc3bf695.png","http:\/\/habrastorage.org\/storage2\/a2b\/cbb\/abd\/a2bcbbabde06bdd990a84c7382ffc34c.png","http:\/\/habrastorage.org\/storage2\/37a\/3ff\/639\/37a3ff639d2cc687f3442562e70b4263.png","http:\/\/habrastorage.org\/storage2\/708\/8b1\/7be\/7088b17be97ead2bfc8ea5b2ca39979b.png","http:\/\/habrastorage.org\/storage2\/e70\/fef\/ac8\/e70fefac8bb0141b43eb0ae3200cb3d0.png","http:\/\/habrastorage.org\/storage2\/fe9\/d49\/ca4\/fe9d49ca448a7e212db0f535e7feeca8.png","http:\/\/habrastorage.org\/storage2\/111\/d46\/39d\/111d4639dbda82505ca79cad7c7a65d9.png","http:\/\/habrastorage.org\/storage2\/494\/4e0\/f5b\/4944e0f5b179a8cbb82dda9b73c4c4aa.png","http:\/\/habrastorage.org\/storage2\/b95\/fe4\/868\/b95fe486831408e68c8697f942375c83.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.90.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Ropes — быстрые строки" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Ropes — быстрые строки" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Ropes — быстрые строки" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="144736" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2012-05-29T07:59:07.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/post/144736/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="строки, ropes, быстрые строки, строки на деревьях, rope string, rope">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/144736/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/144736/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habr.com/share/publication/144736/87cf735ed8085b085b9f93da254035ca/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header data-test-id="header" class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" data-test-id="search-button" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div data-test-id="article-body" class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2012-05-29T07:59:07.000Z" title="2012-05-29, 11:59">29  мая  2012 в 11:59</time></span></div> <!----></div> <h1 data-test-id="articleTitle" lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Ropes — быстрые строки</span></h1> <div data-test-id="articleHubsList" class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div data-test-id="articleLabels" class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label tm-article-snippet__label_variant-sandbox"><span>
        Из песочницы
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Здравствуй, Хабр.<br/>
Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться к отдельным символам по индексу. Мы давно привыкли что строки — это массивы символов фиксированной длины, а это влечет за собой соответствующие ограничения в работе с ними. <br/>
Так, мы не можем быстро объединить две строки — для этого нам потребуется сначала выделить необходимое количество памяти, а потом скопировать туда данные из конкатенируемых строк. Очевидно, что такая операция имеет сложность порядка О(n), где n — суммарная длина строк.<br/>
Именно поэтому код <br/>
<br/>
<pre><code class="cs">string s = "";
for (int i = 0; i &lt; 100000; i++) s += "a";</code></pre><br/>
работает так медленно.<br/>
<br/>
Хочешь выполнять конкатенацию гигантских строк быстро? Не нравится, что строка требует для хранения непрерывную область памяти? Надоело использовать буферы для построения строк?<br/>
<br/>
<a name="habracut"></a><br/>
Структура данных, которая нас спасет, называется <b>Rope string</b>, или «веревочная строка». Принцип ее работы очень прост и до него можно догадаться буквально из интуитивных соображений.<br/>
<br/>
<h4>Идея</h4><br/>
Пусть нам требуется сложить две строки:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/568/80a/c96/56880ac966d7cd11be5a704edc3bf695.png" alt="image" data-src="http://habrastorage.org/storage2/568/80a/c96/56880ac966d7cd11be5a704edc3bf695.png"/></div><br/>
<br/>
Для классических строк мы просто выделим область памяти необходимого размера, в начало её скопируем содержимое первой строки, а в конец — второй:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/a2b/cbb/abd/a2bcbbabde06bdd990a84c7382ffc34c.png" alt="image" data-src="http://habrastorage.org/storage2/a2b/cbb/abd/a2bcbbabde06bdd990a84c7382ffc34c.png"/></div><br/>
<br/>
Как уже упоминалось выше, сложность этой операции — O(n).<br/>
<br/>
Но что если мы используем информацию о том что наша результирующая строка — это конкатенация двух исходных? И действительно, создадим объект который предоставляет интерфейс строки и хранит в себе информацию о своих компонентах — исходных строках:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/37a/3ff/639/37a3ff639d2cc687f3442562e70b4263.png" alt="image" data-src="http://habrastorage.org/storage2/37a/3ff/639/37a3ff639d2cc687f3442562e70b4263.png"/></div><br/>
<br/>
Такой способ объединения строк работает за О(1) — нам нужно лишь создать объект-обертку для исходных строк. Так как этот объект — тоже строка, его можно комбинировать с другими строками для получения нужных нам конкатенаций:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/708/8b1/7be/7088b17be97ead2bfc8ea5b2ca39979b.png" alt="image" data-src="http://habrastorage.org/storage2/708/8b1/7be/7088b17be97ead2bfc8ea5b2ca39979b.png"/></div><br/>
<br/>
Уже сейчас очевидно что наша структура — это двоичное дерево поиска, в листьях которого находятся элементарные составляющие нашей строки — группы символов. Так же очевидным становится способ перечисления символов строки — это обход дерева в глубину с последовательным перечислением символов в листьях дерева.<br/>
<br/>
<h4>Индексация</h4><br/>
Реализуем теперь операцию получения символа строки по его индексу. Для этого введем узлам дерева дополнительную характеристику — вес. Если в узле дерева хранится непосредственно часть символов (узел — лист) то его вес равен количеству этих символов. Иначе, вес узла равен сумме весов его потомков. Иными словами, вес узла — длина строки, которую он представляет.<br/>
<br/>
Нам необходимо получить i-й символ строки, представленной узлом Node. Тогда могут возникнуть два случая:<br/>
<ul>
<li>Узел — лист. Тогда он содержит непосредственно данные и нам достаточно вернуть i-й символ «внутренней» строки.</li>
<li>Узел — составной. Тогда необходимо узнать в каком потомке узла следует продолжить поиск. Если вес левого потомка больше i — искомый символ является i-м символом левой подстроки, иначе он является (i-w)-м символом правой подстроки, где w — вес левого поддерева.</li>
</ul>После этих выкладок рекурсивный вариант алгоритма (как впрочем и итеративный) становится очевидным.<br/>
<br/>
Теперь мы умеем конкатенировать строки за О(1) и индексировать символы в них за О(h) — высоты дерева. Но для полного счастья необходимо научится быстро выполнять операции разбиения на две строки, удаления и вставки подстроки.<br/>
<br/>
<h4>Разбиение</h4><br/>
Итак, у нас есть строка и нам крайне необходимо разбить её на две подстроки в некоторой её позиции k (числа на схеме — размеры соответствующих деревьев):<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/e70/fef/ac8/e70fefac8bb0141b43eb0ae3200cb3d0.png" alt="image" data-src="http://habrastorage.org/storage2/e70/fef/ac8/e70fefac8bb0141b43eb0ae3200cb3d0.png"/></div><br/>
<br/>
Место «разрыва» строки всегда находится в одном из листьев дерева. Разобьем этот лист на два новых, содержащих подстроки исходного листа. Причем для этой операции нам не понадобится копировать содержимое листа в новые, просто введем такие характеристики листа как offset и length и сохраним в новых листах указатели на массив символов исходного, изменив лишь смещение и длину:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/fe9/d49/ca4/fe9d49ca448a7e212db0f535e7feeca8.png" alt="image" data-src="http://habrastorage.org/storage2/fe9/d49/ca4/fe9d49ca448a7e212db0f535e7feeca8.png"/></div><br/>
<br/>
Далее будем расщеплять все узлы на пути от листа к корню, создавая вместо них пары узлов, принадлежащих, соответственно, левой и правой создаваемой подстроке. Причем мы опять же никак не изменяем текущий узел, а лишь создаем вместо него два новых. Это значит операция разделения строки порождает новые подстроки, не затрагивая исходную. После расщепления исходной строки мы получим две новые строки, как на рисунке ниже.<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/111/d46/39d/111d4639dbda82505ca79cad7c7a65d9.png" alt="image" data-src="http://habrastorage.org/storage2/111/d46/39d/111d4639dbda82505ca79cad7c7a65d9.png"/></div><br/>
<br/>
Нетрудно заметить что внутренняя структура таких строк не оптимальна — некоторые явно лишние. Однако исправить это досадное упущение легко — достаточно в обоих подстроках пройтись от места разреза к корню, заменяя каждый узел, имеющий ровно одного потомка этим самым потомком. После этого все лишние узлы пропадут и мы получим требуемые подстроки в их конечном виде:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/494/4e0/f5b/4944e0f5b179a8cbb82dda9b73c4c4aa.png" alt="image" data-src="http://habrastorage.org/storage2/494/4e0/f5b/4944e0f5b179a8cbb82dda9b73c4c4aa.png"/></div><br/>
<br/>
Сложность же операции разбиения строк составляет, очевидно, О(h).<br/>
<br/>
<h4>Удаление и вставка</h4><br/>
Благодаря реализованным уже операциям разбиения и слияния удаление и вставка делаются элементарно — для удаления подстроки достаточно разбить исходную строку в местах начала и окончания удаляемого участка и склеить крайние строки. Для вставки в строки в определенную позицию разобьем в ней исходную строку на две подстроки и склеим их со вставляемой в нужном порядке. Обе операции имеют асимптотику О(h).<br/>
<br/>
<h4>Оптимизация</h4><br/>
<h5>Балансировка</h5><br/>
Внимательный читатель, услышав слово «дерево» неизбежно вспомнил бы и два других — «логарифм» и «балансировка». И, как всегда, чтобы достичь заветной логарифмической асимптотики придется все таки балансировать наше дерево. Действительно, при нынешнем способе слияния строк внутренняя структура дерева будет похожа скорее на «лестницу», например такую, как на рисунке ниже:<br/>
<br/>
<div style="text-align:center;"><img src="http://habrastorage.org/r/w1560/storage2/b95/fe4/868/b95fe486831408e68c8697f942375c83.png" alt="image" data-src="http://habrastorage.org/storage2/b95/fe4/868/b95fe486831408e68c8697f942375c83.png"/></div><br/>
<br/>
Чтобы этого избежать, будем при каждом объединении строк проверять сбалансированность результата и при необходимости пересобирать все дерево, балансируя его. Хорошее условие сбалансированности — длина строки должна быть не меньше (h+2) — го числа Фибоначчи. Обоснование этого условия а также пара дополнительных модификаций операции склейки были даны Боэмом, Аткинсоном и Плассом в их работе <a href="http://citeseer.ist.psu.edu/viewdoc/download?doi=10.1.1.14.9450&amp;rep=rep1&amp;type=pdf">Ropes: an Alternative to Strings</a><br/>
<br/>
<h5>Прямое объединение малых строк</h5><br/>
Хранение в памяти узлов дерева вовсе не бесплатно. Если к строке прибавлять по одному символу то мы потратим на хранение информации об узлах дерева на порядок больше памяти, чем на сами символы строки. Во избежание таких ситуаций, а также для уменьшения высоты дерева целесообразно склеивать строки меньше некоторой длины (например, 32) «классическим» способом. Это сильно сэкономит память а также почти не отразится на производительности в целом.<br/>
<br/>
<h5>Кэширование последней позиции</h5><br/>
В подавляющем числе случаев мы перебираем символы строки последовательно. В нашем случае, если мы запрашиваем символы по индексам i и i+1 очень велика вероятность того что физически они находятся в одном и том же листе дерева. Это значит что при поиске этих символов мы будем повторять один и тот же путь от корня дерева до листа. Очевидное решение этой проблемы — кэширование. Для этого при поиске очередного символа запомним лист в котором он находится и диапазон индексов, которые этот лист в себе содержит. После, при поиске очередного символа сперва будем проверять, лежит ли наш индекс в запомненном диапазоне и, если это так, будем искать его непосредственно в запомненном листе. Можно даже пойти дальше, запоминая не одну последнюю позицию а несколько, например, в циклическом списке.<br/>
<br/>
Вкупе с предыдущей оптимизацией такая техника позволит нам улучшить асимптотику индексации с O(ln(n)) практически до О(1).<br/>
<br/>
<h4>Итог</h4><br/>
Что же мы в результате получим? Мы получим персистентную реализацию строки, не требующую для своего хранения непрерывной области памяти, с логарифмической асимптотикой вставки, удаления и конкатенации (вместо O(n) у классических строк) и индексацией почти за О(1) — вполне достойный внимания результат.<br/>
<br/>
Ну и напоследок приведу пару полезных ссылок: <a href="http://en.wikipedia.org/wiki/Rope_(computer_science)">статья в английской wiki</a>, <a href="http://www.ahmadsoft.org/source/xref/ropes-1.2.5/src/org/ahmadsoft/ropes/">реализация на Java</a> и <a href="http://www.sgi.com/tech/stl/Rope.html">описание С++ реализации на сайте SGI</a>. <br/>
<br/>
Use the ropes, Luke!</div></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----></div> <div data-test-id="article-meta-links" class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B8%5D" class="tm-tags-list__link">строки</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bropes%5D" class="tm-tags-list__link">ropes</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B1%D1%8B%D1%81%D1%82%D1%80%D1%8B%D0%B5%20%D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B8%5D" class="tm-tags-list__link">быстрые строки</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B8%20%D0%BD%D0%B0%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%D1%85%5D" class="tm-tags-list__link">строки на деревьях</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Brope%20string%5D" class="tm-tags-list__link">rope string</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Brope%5D" class="tm-tags-list__link">rope</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/algorithms/" class="tm-hubs-list__link">Алгоритмы</a></li></ul></div></div></article></div> <!----></div> <div data-test-id="article-sticky-panel" class="tm-article-sticky-panel"><div data-test-id="article-stats-icons" class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 87: ↑83 и ↓4</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 87: ↑83 и ↓4" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+79</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">22K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    336
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/144736/comments/" data-test-id="counter-comments" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      36
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <DIV class="v-portal" style="display:none;"></DIV> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div data-test-id="article-author-info" class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/Flux/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 304 голоса " class="tm-karma tm-user-card__karma tm-karma"><div class="tm-karma__votes tm-karma__votes_positive">
    22
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter tm-rating__counter">0.8</div></div> <div class="tm-rating__text tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/Flux/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @Flux
        </a> <!----></div> <p data-test-id="user-card-speciality" class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">ML engineer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-adfox-banner__container tm-page-article__banner"><!----> <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div></div> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div data-test-id="article-comments" data-async-called="true" class="tm-article-comments"><div class="tm-comments-wrapper"><div class="tm-comments-wrapper__wrapper"><header class="tm-comments-wrapper__header"><h2 class="tm-comments-wrapper__title">
        Комментарии
        <span class="tm-comments-wrapper__comments-count">
          36
        </span></h2> <div class="tm-comments-wrapper__header-aside"><!----> <button class="tm-rss-button tm-rss-button_comments-header"><span class="tm-svg-icon__wrapper tm-rss-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Скопировать ссылку на RSS</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#rss"></use></svg></span></button> <!----></div></header> <div class="tm-comments-wrapper__inner"> <!----> <div data-comments-list="" class="tm-comments__tree"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861882" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861882" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Skiminok/" data-test-id="user-info-pic" title="Skiminok" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/d23/ed4/4cf/d23ed44cf8d9f76e24a0a2a39616553a.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Skiminok/" class="tm-user-info__username">
      Skiminok
    </a> <a href="#comment_4861882" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:25
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Классная штука Rope, да. Только на Хабре уже <a href="http://habrahabr.ru/post/112394/">была</a>, хотя и не так конкретно.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑1 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑1 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861882" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861937" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861937" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> <a href="#comment_4861937" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:34
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">И верно. Признаюсь, не нашел этот топик поиском — выдает лишь результаты типа «Cut the rope» и им подобные. В любом случае, подробное рассмотрение структуры думаю не помешает — уж больно мало про неё информации в рунете встечается.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 3: ↑3 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 3: ↑3 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+3</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861937" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861886" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861886" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Nigrimmist/" data-test-id="user-info-pic" title="Nigrimmist" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/e18/6db/94e/e186db94ea04befce3e0c07b4eb9aa1e.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Nigrimmist/" class="tm-user-info__username">
      Nigrimmist
    </a> <a href="#comment_4861886" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:26
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Ну конечно медленно, если не использовать StringBuilder (в C#, в других яп думаю тоже есть аналоги):<br/>
<br/>
<pre><code class="cs">StringBuilder sb = new StringBuilder(String.empty);
for (int i = 0; i &lt; 100000; i++) sb.Append("a");
</code></pre></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 6: ↑3 и ↓3</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 6: ↑3 и ↓3" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861886" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861955" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861955" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> <a href="#comment_4861955" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:37
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Там как раз в следующем абзаце про такие билдеры написано. Это классический код с объяснением почему нельзя складывать строки именно таким образом.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861955" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861965" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861965" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/bask/" data-test-id="user-info-pic" title="bask" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/b22/464/91e/b2246491ed722de679def797d654ff4b.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/bask/" class="tm-user-info__username">
      bask
    </a> <a href="#comment_4861965" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:39
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Либо StringBuilder(), либо String.Format()</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861965" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861986" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861986" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sneer/" data-test-id="user-info-pic" title="sneer" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/sneer/" class="tm-user-info__username">
      sneer
    </a> <a href="#comment_4861986" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:43
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content tm-comment__body-content_muted" style="opacity:0.5;"><div xmlns="http://www.w3.org/1999/xhtml">StringBuilder сильно проигрывает Ropes</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 10: ↑3 и ↓7</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 10: ↑3 и ↓7" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_negative tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">-4</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861986" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862304" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862304" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Weageoo/" data-test-id="user-info-pic" title="Weageoo" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/6a8/894/930/6a889493036fd5f8f4489a37fccb17f7.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Weageoo/" class="tm-user-info__username">
      Weageoo
    </a> <a href="#comment_4862304" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:33
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">У вас и имплементация Rope есть, наверное, для .NET?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862304" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862390" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862390" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/B08AH/" data-test-id="user-info-pic" title="B08AH" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/B08AH/" class="tm-user-info__username">
      B08AH
    </a> <a href="#comment_4862390" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:45
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Даешь бенчмарки!<br/>
Мой прогноз — незначительная разница при построении строки, а при сравнении строк огромный, в несколько порядков отрыв по скорости «обычного порошка» от веревочных строк.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862390" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4863624" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-3"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4863624" class="tm-comment-thread__indent_l-3"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sneer/" data-test-id="user-info-pic" title="sneer" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/sneer/" class="tm-user-info__username">
      sneer
    </a> <a href="#comment_4863624" class="tm-comment-thread__comment-link">
                29.05.2012 в 17:55
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><a href="http://www.ibm.com/developerworks/java/library/j-ropes/">www.ibm.com/developerworks/java/library/j-ropes/</a></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑1 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑1 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4863624" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864482" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-4"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864482" class="tm-comment-thread__indent_l-4"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/B08AH/" data-test-id="user-info-pic" title="B08AH" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/B08AH/" class="tm-user-info__username">
      B08AH
    </a> <a href="#comment_4864482" class="tm-comment-thread__comment-link">
                29.05.2012 в 22:35
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Ожидаемо операции на «результирующей» строке медленнее, в частности и без того медленные регулярные выражения(в 2-10 раз медленннее с#/Java кода <a href="http://habrahabr.ru/post/126954/">habrahabr.ru/post/126954/</a> — например ) еще в 3-30 раз замедляются.<br/>
<br/>
Потестил StringBuilder в С#, Append скейлится линейно, в 10 раз увеличил количество итераций — в 10 раз выросло время, а вот Insert, как и в этих бенчмарках, геометрической прогрессией растет.<br/>
<br/>
Возможно имеет смысл конструировать строку этим методом(сделать RopeBuilder какой нибудь), если нужен именно быстрый Insert, а затем так же как и StringBuilder экспортировать в обычную immutable строку, в которой быстрее другие операции.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864482" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4865508" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4865508" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Xitsa/" data-test-id="user-info-pic" title="Xitsa" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/023/371/aa3/023371aa312aa5990078153ce00203be.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Xitsa/" class="tm-user-info__username">
      Xitsa
    </a> <a href="#comment_4865508" class="tm-comment-thread__comment-link">
                30.05.2012 в 10:33
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">А я оставлю пару комментариев Эрика Липперта:<br/>
<a href="http://stackoverflow.com/q/1862703/1285120">1:</a><br/>
<blockquote>If you have a scenario where this data structure is more optimal than a string builder, I would be curious to know what it is. It has been my experience that rope data structures are almost never a win over the raw speed of native string or string builder operations in typical cases, so I am very interested to see realistic scenarios where its a win.</blockquote><br/>
<br/>
<a href="http://stackoverflow.com/q/1863440/1285120">2:</a><br/>
<blockquote>My experience is admittedly limited; I've tried to add rope-style string representations to languages like VBScript and JScript. The number of cases in which we must aggressively reify internal strings into «real» buffer-based strings was so large, and the number of cases where runtime string manipulations actually grew large, complex strings was so small, that the net perf impact was negative. When we built the string logic in JScript.NET we simply used a stringbuilder rather than attempting ropes again.</blockquote></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4865508" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864964" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864964" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/GreatKoshak/" data-test-id="user-info-pic" title="GreatKoshak" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/130/2fa/521/1302fa521a5aebdc5839fb85755279f0.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/GreatKoshak/" class="tm-user-info__username">
      GreatKoshak
    </a> <a href="#comment_4864964" class="tm-comment-thread__comment-link">
                30.05.2012 в 01:18
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Интересно, одноимённый класс в Java работает так же, как и в C#?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864964" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4866700" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4866700" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/" data-test-id="user-info-pic" class="tm-user-info__userpic router-link-active"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/" class="tm-user-info__username router-link-active">
      
    </a> <a href="#comment_4866700" class="tm-comment-thread__comment-link">
                30.05.2012 в 16:07
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">НЛО прилетело и опубликовало эту надпись здесь</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4866700" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861894" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861894" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/maxidler/" data-test-id="user-info-pic" title="maxidler" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/8e5/6f2/f24/8e56f2f2457df0b79da2deb37e1b537d.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/maxidler/" class="tm-user-info__username">
      maxidler
    </a> <a href="#comment_4861894" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:27
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Мне кажется в этом случае сильно возрастает сложность алгоритма сравнения строк, а соответсвенно и сортировки.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 7: ↑6 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 7: ↑6 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+5</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861894" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861910" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861910" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/UncleAndy/" data-test-id="user-info-pic" title="UncleAndy" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/165/85b/970/16585b97067cf198684868467e794676.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/UncleAndy/" class="tm-user-info__username">
      UncleAndy
    </a> <a href="#comment_4861910" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:30
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Да, тоже подумал как такие строки будут в регулярных выражениях обрабатываться. :) Но если такой необходимости нет по задаче — почему нет?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861910" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861982" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861982" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> <a href="#comment_4861982" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:42
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Со сравнением строк все нормально как раз. Сравнение требует последовательного перебора символов который за счет кэширования последнего индекса работает быстро. Порядок сложности не увеличится, увеличится только константа.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861982" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862038" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862038" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/serso/" data-test-id="user-info-pic" title="serso" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/aac/077/527/aac07752700b22fbef7a0756166a89ba.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/serso/" class="tm-user-info__username">
      serso
    </a> <a href="#comment_4862038" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:50
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Нет, сложность алгоритма не возрастёт, а останется прежней = o(n), где n — длина строки.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862038" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4861903" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4861903" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/UncleAndy/" data-test-id="user-info-pic" title="UncleAndy" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/165/85b/970/16585b97067cf198684868467e794676.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/UncleAndy/" class="tm-user-info__username">
      UncleAndy
    </a> <a href="#comment_4861903" class="tm-comment-thread__comment-link">
                29.05.2012 в 12:29
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Интересный способ. Возможно, имело-бы смысл использовать nested sets для каких-то операций (веса — похожий прием, но не много не тот). Интуитивно мне кажется что при этом не пострадает скорость операций.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4861903" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862100" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862100" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/nickme/" data-test-id="user-info-pic" title="nickme" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/18c/74e/281/18c74e2810fc28eff60c9f7f31dc7eb4.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/nickme/" class="tm-user-info__username">
      nickme
    </a> <a href="#comment_4862100" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:00
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Спасибо за статью (и ссылки), познавательно!<br/>
<br/>
ЗЫ: Кмк получаемое дерево все-таки не двоичное дерево <i>поиска</i>, нет? </div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862100" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862134" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862134" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> <a href="#comment_4862134" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:05
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">В строгой формулировке, конечно, нет. Но при индексации символа аналогия с BST наиболее естественная — мы просто ищем другие объекты и правило выбора очередного узла немного модифицировано.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862134" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862338" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862338" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/TheHorse/" data-test-id="user-info-pic" title="TheHorse" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/92a/807/6da/92a8076da7316357041660b7ebcafb95.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/TheHorse/" class="tm-user-info__username">
      TheHorse
    </a> <a href="#comment_4862338" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:38
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Я в свой проекте на Delphi был вынужден что-то подобное строить. У меня строки доходили до 2 500 000 символов, и беда была не в скорости, а в проблеме сегментации строк. Эта проблема вызывала exception «out of mem».<br/>
<br/>
Следует упомянуть, что для Delphi 7 (на других не проверял), такой подход помимо скорости дает и прирост отказоустойчивости. </div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 6: ↑3 и ↓3</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 6: ↑3 и ↓3" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862338" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862446" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862446" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/appplemac/" data-test-id="user-info-pic" title="appplemac" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/495/8b5/bf1/4958b5bf1e00d3641d119a4a91423cef.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/appplemac/" class="tm-user-info__username">
      appplemac
    </a> <a href="#comment_4862446" class="tm-comment-thread__comment-link">
                29.05.2012 в 13:53
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">А есть готовая интерпретация на C++?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862446" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862606" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862606" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Flux/" data-test-id="user-info-pic" title="Flux" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/bb9/0be/68a/bb90be68abfe3b53041bf6f9143f44a2.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Flux/" class="tm-user-info__username">
      Flux
    </a> <a href="#comment_4862606" class="tm-comment-thread__comment-link">
                29.05.2012 в 14:22
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">У <a href="http://www.sgi.com/">SGI</a> есть <a href="http://www.sgi.com/tech/stl/download.html">имплементация STL</a> в которой есть <a href="http://www.sgi.com/tech/stl/Rope.html">соответствующий контейнер</a>.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862606" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4862918" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4862918" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Goder/" data-test-id="user-info-pic" title="Goder" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/444/83b/c8d/44483bc8d11fe722ca8f1fec89799603.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Goder/" class="tm-user-info__username">
      Goder
    </a> <a href="#comment_4862918" class="tm-comment-thread__comment-link">
                29.05.2012 в 15:32
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Как тут уже говорили, даешь бенчмарки! :)<br/>
Ещё интересно, как давно вам приходилось соединять 100 000 строк в цикле?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4862918" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864705" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864705" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Kilew/" data-test-id="user-info-pic" title="Kilew" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/21b/007/443/21b0074437446eb4f9a92215c7e90add.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Kilew/" class="tm-user-info__username">
      Kilew
    </a> <a href="#comment_4864705" class="tm-comment-thread__comment-link">
                29.05.2012 в 23:48
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">В 2007 году на ICFP Contest'e, когда <a href="http://save-endo.cs.uu.nl/">спасали Endo</a><br/>
<a href="http://save-endo.cs.uu.nl/">save-endo.cs.uu.nl/</a><br/>
Похожую структуру и применяли.<br/>
<br/>
В практических задачах — вряд ли встретится, но структура хороша, если стоит задача в быстрой генерации больших текстовых данных.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864705" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4863612" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4863612" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/ComodoHacker/" data-test-id="user-info-pic" title="ComodoHacker" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/757/219/8d4/7572198d49e15fd09b77918367b1790c.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/ComodoHacker/" class="tm-user-info__username">
      ComodoHacker
    </a> <a href="#comment_4863612" class="tm-comment-thread__comment-link">
                29.05.2012 в 17:51
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Хотелось бы обозначить область применимости такого хранения.<br/>
<br/>
Первый ваш пример уже вызывает сомнения. Что будет в памяти после<br/>
for (int i = 0; i &lt; 100000; i++) s += «a»;<br/>
Будет ли это лучше StringBuilder?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4863612" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864190" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864190" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Juster/" data-test-id="user-info-pic" title="Juster" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/098/aba/f93/098abaf9337ea268ceb4e9311784f079.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Juster/" class="tm-user-info__username">
      Juster
    </a> <a href="#comment_4864190" class="tm-comment-thread__comment-link">
                29.05.2012 в 21:03
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Об области применения можно почитать немного здесь: <a href="http://www.ibm.com/developerworks/java/library/j-ropes/">www.ibm.com/developerworks/java/library/j-ropes/</a></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864190" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864736" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864736" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/ComodoHacker/" data-test-id="user-info-pic" title="ComodoHacker" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/757/219/8d4/7572198d49e15fd09b77918367b1790c.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/ComodoHacker/" class="tm-user-info__username">
      ComodoHacker
    </a> <a href="#comment_4864736" class="tm-comment-thread__comment-link">
                29.05.2012 в 23:57
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Спасибо. Ее качественный перевод с успехом заменил бы эту статью. :)</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864736" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864201" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864201" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/mclander/" data-test-id="user-info-pic" title="mclander" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/4cc/a18/2d1/4cca182d17aa40fc9aabd56bcbb2eb27.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/mclander/" class="tm-user-info__username">
      mclander
    </a> <a href="#comment_4864201" class="tm-comment-thread__comment-link">
                29.05.2012 в 21:06
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Я обычно использую массив строк.<br/>
<br/>
Тем более конкатенация для много-много-много строк требуется как правило один раз (для вывода, например, в поток, в который, кстати можно скормить массив и без конкатенации).</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864201" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864396" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864396" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/kashey/" data-test-id="user-info-pic" title="kashey" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/902/c7a/49b/902c7a49be188965de879f924b676efc.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/kashey/" class="tm-user-info__username">
      kashey
    </a> <a href="#comment_4864396" class="tm-comment-thread__comment-link">
                29.05.2012 в 22:12
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Вот такие строки в WebKit используются.<br/>
И не всегда это хорошо — ибо эта зараза будет каждый раз при обращении к строке ее собирать.<br/>
Иногда крайне не приятно и не понятно получается</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864396" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4864836" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4864836" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/kaaquantum/" data-test-id="user-info-pic" title="kaaquantum" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/469/be3/891/469be3891f024cea803b6be71ffc8200.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/kaaquantum/" class="tm-user-info__username">
      kaaquantum
    </a> <a href="#comment_4864836" class="tm-comment-thread__comment-link">
                30.05.2012 в 00:26
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content tm-comment__body-content_muted" style="opacity:0.7;"><div xmlns="http://www.w3.org/1999/xhtml">А для питона есть адекватная реализация?</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 4: ↑1 и ↓3</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 4: ↑1 и ↓3" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_negative tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">-2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4864836" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4868115" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4868115" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/kaaquantum/" data-test-id="user-info-pic" title="kaaquantum" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/469/be3/891/469be3891f024cea803b6be71ffc8200.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/kaaquantum/" class="tm-user-info__username">
      kaaquantum
    </a> <a href="#comment_4868115" class="tm-comment-thread__comment-link">
                31.05.2012 в 00:27
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">А минусы то за что?!</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑1 и ↓1</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑1 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4868115" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4865089" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4865089" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/ivertex/" data-test-id="user-info-pic" title="ivertex" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/ivertex/" class="tm-user-info__username">
      ivertex
    </a> <a href="#comment_4865089" class="tm-comment-thread__comment-link">
                30.05.2012 в 02:36
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Ок, все вроде так офигенно, но… Данный паттерн используется повсеместно и, к сожалению не является серебрянной пулей. Такие решения применяются для более узконаправленных типов данных, что как бы обоснованно (на основе данных профилированния). Но если говорить о строках, ребята настолько разнообразно ими пользуются, что сделать серьезно эффективнее чем strcmp или strcpy (ок, плюсовые варианты) ну нет, чудес не бывает. Либо память, либо такты. Ну либо более специализированные варианты, которые привели выше.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4865089" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4865507" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4865507" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/B08AH/" data-test-id="user-info-pic" title="B08AH" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#placeholder-user"></use></svg></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/B08AH/" class="tm-user-info__username">
      B08AH
    </a> <a href="#comment_4865507" class="tm-comment-thread__comment-link">
                30.05.2012 в 10:33
                <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Мне понравилось как это реализовано в C# — обе эти операции фактически являются сравнением двух ссылок(strcmp), и присвоением ссылки(strcpy).<br/>
С ограничением — сравнение только на предмет равно-не равно, а не для сортировки больше-меньше.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4865507" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_4865651" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="4865651" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Aco/" data-test-id="user-info-pic" title="Aco" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/427/c95/b4d/427c95b4d0fd1a8626ec20a426d9dda1.jpg" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/Aco/" class="tm-user-info__username">
      Aco
    </a> <a href="#comment_4865651" class="tm-comment-thread__comment-link">
                30.05.2012 в 11:30
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">если не ошибаюсь, то у libevent буфер-ы так и работают</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="4865651" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_7359407" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="7359407" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/roman_kashitsyn/" data-test-id="user-info-pic" title="roman_kashitsyn" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/aa2/099/ccd/aa2099ccdec6880411b60a4dc3b335d7.png" width="24" class="tm-entity-image__pic"></div></a> <span data-test-id="user-info-description" class="tm-user-info__user"><a href="/ru/users/roman_kashitsyn/" class="tm-user-info__username">
      roman_kashitsyn
    </a> <a href="#comment_7359407" class="tm-comment-thread__comment-link">
                27.02.2014 в 16:49
                <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Похожая структура Twine используется в <a href="http://llvm.org/docs/ProgrammersManual.html#llvm-adt-twine-h">LLVM</a>.<br/>
<br/>
Можно также заметить, что такую структуру данных можно сделать персистентной и использовать для реализации функционала DO-UNDO. Правда, деталей реализации у такого решения довольно много.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-rating"></use></svg> <span data-test-id="votes-meter-value" title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="7359407" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v25.9b4a34a5.svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div>  <DIV class="v-portal" style="display:none;"></DIV></div></div> <div class="tm-notice tm-comments__comment-notice tm-notice_positive"><!----> <div class="tm-notice__inner"><!----> <div data-test-id="notice-content" class="tm-notice__content"><span>Только полноправные пользователи могут оставлять комментарии. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/post/144736/&hl=ru">Войдите</a>, пожалуйста.</span></div></div></div></div></div></div></div>  <!----> <div><div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div> <div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div> <div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div></div></div></div></div></div> <div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-tasks"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----> <!----> <!----> <!----></div> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top"><!----> <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----> <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom"><!----> <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div></div></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/144736/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/144736/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2022, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"144736":{"id":"144736","timePublished":"2012-05-29T07:59:07+00:00","isCorporative":false,"lang":"ru","titleHtml":"Ropes — быстрые строки","leadData":{"textHtml":"Здравствуй, Хабр.\u003Cbr\u002F\u003E\r\nБольшинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться к отдельным символам по индексу. Мы давно привыкли что строки — это массивы символов фиксированной длины, а это влечет за собой соответствующие ограничения в работе с ними. \u003Cbr\u002F\u003E\r\nТак, мы не можем быстро объединить две строки — для этого нам потребуется сначала выделить необходимое количество памяти, а потом скопировать туда данные из конкатенируемых строк. Очевидно, что такая операция имеет сложность порядка О(n), где n — суммарная длина строк.\u003Cbr\u002F\u003E\r\nИменно поэтому код \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Estring s = &quot;&quot;;\nfor (int i = 0; i &lt; 100000; i++) s += &quot;a&quot;;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nработает так медленно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХочешь выполнять конкатенацию гигантских строк быстро? Не нравится, что строка требует для хранения непрерывную область памяти? Надоело использовать буферы для построения строк?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Хватит это терпеть!","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"sandbox","data":null}],"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer","scoreStats":{"score":22,"votesCount":304},"rating":0.8,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":36,"favoritesCount":336,"readingCount":21694,"score":79,"votesCount":87},"hubs":[{"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЗдравствуй, Хабр.\u003Cbr\u002F\u003E\r\nБольшинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться к отдельным символам по индексу. Мы давно привыкли что строки — это массивы символов фиксированной длины, а это влечет за собой соответствующие ограничения в работе с ними. \u003Cbr\u002F\u003E\r\nТак, мы не можем быстро объединить две строки — для этого нам потребуется сначала выделить необходимое количество памяти, а потом скопировать туда данные из конкатенируемых строк. Очевидно, что такая операция имеет сложность порядка О(n), где n — суммарная длина строк.\u003Cbr\u002F\u003E\r\nИменно поэтому код \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Estring s = \"\";\nfor (int i = 0; i &lt; 100000; i++) s += \"a\";\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nработает так медленно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХочешь выполнять конкатенацию гигантских строк быстро? Не нравится, что строка требует для хранения непрерывную область памяти? Надоело использовать буферы для построения строк?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nСтруктура данных, которая нас спасет, называется \u003Cb\u003ERope string\u003C\u002Fb\u003E, или «веревочная строка». Принцип ее работы очень прост и до него можно догадаться буквально из интуитивных соображений.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EИдея\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nПусть нам требуется сложить две строки:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002F568\u002F80a\u002Fc96\u002F56880ac966d7cd11be5a704edc3bf695.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002F568\u002F80a\u002Fc96\u002F56880ac966d7cd11be5a704edc3bf695.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля классических строк мы просто выделим область памяти необходимого размера, в начало её скопируем содержимое первой строки, а в конец — второй:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002Fa2b\u002Fcbb\u002Fabd\u002Fa2bcbbabde06bdd990a84c7382ffc34c.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002Fa2b\u002Fcbb\u002Fabd\u002Fa2bcbbabde06bdd990a84c7382ffc34c.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак уже упоминалось выше, сложность этой операции — O(n).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо что если мы используем информацию о том что наша результирующая строка — это конкатенация двух исходных? И действительно, создадим объект который предоставляет интерфейс строки и хранит в себе информацию о своих компонентах — исходных строках:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002F37a\u002F3ff\u002F639\u002F37a3ff639d2cc687f3442562e70b4263.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002F37a\u002F3ff\u002F639\u002F37a3ff639d2cc687f3442562e70b4263.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТакой способ объединения строк работает за О(1) — нам нужно лишь создать объект-обертку для исходных строк. Так как этот объект — тоже строка, его можно комбинировать с другими строками для получения нужных нам конкатенаций:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002F708\u002F8b1\u002F7be\u002F7088b17be97ead2bfc8ea5b2ca39979b.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002F708\u002F8b1\u002F7be\u002F7088b17be97ead2bfc8ea5b2ca39979b.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУже сейчас очевидно что наша структура — это двоичное дерево поиска, в листьях которого находятся элементарные составляющие нашей строки — группы символов. Так же очевидным становится способ перечисления символов строки — это обход дерева в глубину с последовательным перечислением символов в листьях дерева.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EИндексация\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nРеализуем теперь операцию получения символа строки по его индексу. Для этого введем узлам дерева дополнительную характеристику — вес. Если в узле дерева хранится непосредственно часть символов (узел — лист) то его вес равен количеству этих символов. Иначе, вес узла равен сумме весов его потомков. Иными словами, вес узла — длина строки, которую он представляет.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНам необходимо получить i-й символ строки, представленной узлом Node. Тогда могут возникнуть два случая:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EУзел — лист. Тогда он содержит непосредственно данные и нам достаточно вернуть i-й символ «внутренней» строки.\u003C\u002Fli\u003E\r\n\u003Cli\u003EУзел — составной. Тогда необходимо узнать в каком потомке узла следует продолжить поиск. Если вес левого потомка больше i — искомый символ является i-м символом левой подстроки, иначе он является (i-w)-м символом правой подстроки, где w — вес левого поддерева.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003EПосле этих выкладок рекурсивный вариант алгоритма (как впрочем и итеративный) становится очевидным.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь мы умеем конкатенировать строки за О(1) и индексировать символы в них за О(h) — высоты дерева. Но для полного счастья необходимо научится быстро выполнять операции разбиения на две строки, удаления и вставки подстроки.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EРазбиение\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nИтак, у нас есть строка и нам крайне необходимо разбить её на две подстроки в некоторой её позиции k (числа на схеме — размеры соответствующих деревьев):\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002Fe70\u002Ffef\u002Fac8\u002Fe70fefac8bb0141b43eb0ae3200cb3d0.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002Fe70\u002Ffef\u002Fac8\u002Fe70fefac8bb0141b43eb0ae3200cb3d0.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМесто «разрыва» строки всегда находится в одном из листьев дерева. Разобьем этот лист на два новых, содержащих подстроки исходного листа. Причем для этой операции нам не понадобится копировать содержимое листа в новые, просто введем такие характеристики листа как offset и length и сохраним в новых листах указатели на массив символов исходного, изменив лишь смещение и длину:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002Ffe9\u002Fd49\u002Fca4\u002Ffe9d49ca448a7e212db0f535e7feeca8.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002Ffe9\u002Fd49\u002Fca4\u002Ffe9d49ca448a7e212db0f535e7feeca8.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее будем расщеплять все узлы на пути от листа к корню, создавая вместо них пары узлов, принадлежащих, соответственно, левой и правой создаваемой подстроке. Причем мы опять же никак не изменяем текущий узел, а лишь создаем вместо него два новых. Это значит операция разделения строки порождает новые подстроки, не затрагивая исходную. После расщепления исходной строки мы получим две новые строки, как на рисунке ниже.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002F111\u002Fd46\u002F39d\u002F111d4639dbda82505ca79cad7c7a65d9.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002F111\u002Fd46\u002F39d\u002F111d4639dbda82505ca79cad7c7a65d9.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНетрудно заметить что внутренняя структура таких строк не оптимальна — некоторые явно лишние. Однако исправить это досадное упущение легко — достаточно в обоих подстроках пройтись от места разреза к корню, заменяя каждый узел, имеющий ровно одного потомка этим самым потомком. После этого все лишние узлы пропадут и мы получим требуемые подстроки в их конечном виде:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002F494\u002F4e0\u002Ff5b\u002F4944e0f5b179a8cbb82dda9b73c4c4aa.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002F494\u002F4e0\u002Ff5b\u002F4944e0f5b179a8cbb82dda9b73c4c4aa.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСложность же операции разбиения строк составляет, очевидно, О(h).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EУдаление и вставка\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nБлагодаря реализованным уже операциям разбиения и слияния удаление и вставка делаются элементарно — для удаления подстроки достаточно разбить исходную строку в местах начала и окончания удаляемого участка и склеить крайние строки. Для вставки в строки в определенную позицию разобьем в ней исходную строку на две подстроки и склеим их со вставляемой в нужном порядке. Обе операции имеют асимптотику О(h).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EОптимизация\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EБалансировка\u003C\u002Fh5\u003E\u003Cbr\u002F\u003E\r\nВнимательный читатель, услышав слово «дерево» неизбежно вспомнил бы и два других — «логарифм» и «балансировка». И, как всегда, чтобы достичь заветной логарифмической асимптотики придется все таки балансировать наше дерево. Действительно, при нынешнем способе слияния строк внутренняя структура дерева будет похожа скорее на «лестницу», например такую, как на рисунке ниже:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"http:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fstorage2\u002Fb95\u002Ffe4\u002F868\u002Fb95fe486831408e68c8697f942375c83.png\" alt=\"image\" data-src=\"http:\u002F\u002Fhabrastorage.org\u002Fstorage2\u002Fb95\u002Ffe4\u002F868\u002Fb95fe486831408e68c8697f942375c83.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы этого избежать, будем при каждом объединении строк проверять сбалансированность результата и при необходимости пересобирать все дерево, балансируя его. Хорошее условие сбалансированности — длина строки должна быть не меньше (h+2) — го числа Фибоначчи. Обоснование этого условия а также пара дополнительных модификаций операции склейки были даны Боэмом, Аткинсоном и Плассом в их работе \u003Ca href=\"http:\u002F\u002Fciteseer.ist.psu.edu\u002Fviewdoc\u002Fdownload?doi=10.1.1.14.9450&amp;rep=rep1&amp;type=pdf\"\u003ERopes: an Alternative to Strings\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EПрямое объединение малых строк\u003C\u002Fh5\u003E\u003Cbr\u002F\u003E\r\nХранение в памяти узлов дерева вовсе не бесплатно. Если к строке прибавлять по одному символу то мы потратим на хранение информации об узлах дерева на порядок больше памяти, чем на сами символы строки. Во избежание таких ситуаций, а также для уменьшения высоты дерева целесообразно склеивать строки меньше некоторой длины (например, 32) «классическим» способом. Это сильно сэкономит память а также почти не отразится на производительности в целом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EКэширование последней позиции\u003C\u002Fh5\u003E\u003Cbr\u002F\u003E\r\nВ подавляющем числе случаев мы перебираем символы строки последовательно. В нашем случае, если мы запрашиваем символы по индексам i и i+1 очень велика вероятность того что физически они находятся в одном и том же листе дерева. Это значит что при поиске этих символов мы будем повторять один и тот же путь от корня дерева до листа. Очевидное решение этой проблемы — кэширование. Для этого при поиске очередного символа запомним лист в котором он находится и диапазон индексов, которые этот лист в себе содержит. После, при поиске очередного символа сперва будем проверять, лежит ли наш индекс в запомненном диапазоне и, если это так, будем искать его непосредственно в запомненном листе. Можно даже пойти дальше, запоминая не одну последнюю позицию а несколько, например, в циклическом списке.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВкупе с предыдущей оптимизацией такая техника позволит нам улучшить асимптотику индексации с O(ln(n)) практически до О(1).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EИтог\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nЧто же мы в результате получим? Мы получим персистентную реализацию строки, не требующую для своего хранения непрерывной области памяти, с логарифмической асимптотикой вставки, удаления и конкатенации (вместо O(n) у классических строк) и индексацией почти за О(1) — вполне достойный внимания результат.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНу и напоследок приведу пару полезных ссылок: \u003Ca href=\"http:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FRope_(computer_science)\"\u003Eстатья в английской wiki\u003C\u002Fa\u003E, \u003Ca href=\"http:\u002F\u002Fwww.ahmadsoft.org\u002Fsource\u002Fxref\u002Fropes-1.2.5\u002Fsrc\u002Forg\u002Fahmadsoft\u002Fropes\u002F\"\u003Eреализация на Java\u003C\u002Fa\u003E и \u003Ca href=\"http:\u002F\u002Fwww.sgi.com\u002Ftech\u002Fstl\u002FRope.html\"\u003Eописание С++ реализации на сайте SGI\u003C\u002Fa\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nUse the ropes, Luke!\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"строки"},{"titleHtml":"ropes"},{"titleHtml":"быстрые строки"},{"titleHtml":"строки на деревьях"},{"titleHtml":"rope string"},{"titleHtml":"rope"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F144736\u002F87cf735ed8085b085b9f93da254035ca\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F144736\u002F87cf735ed8085b085b9f93da254035ca\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F144736\\\u002F\"},\"headline\":\"Ropes — быстрые строки\",\"datePublished\":\"2012-05-29T11:59:07+04:00\",\"dateModified\":\"2012-05-29T14:17:30+04:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Flux\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать &mdash; если ты пишешь код, ты обречен каждый день складывать строки, разбив...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F144736\\\u002F#post-content-body\",\"about\":[\"h_algorithms\",\"f_develop\"],\"image\":[\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002F568\\\u002F80a\\\u002Fc96\\\u002F56880ac966d7cd11be5a704edc3bf695.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002Fa2b\\\u002Fcbb\\\u002Fabd\\\u002Fa2bcbbabde06bdd990a84c7382ffc34c.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002F37a\\\u002F3ff\\\u002F639\\\u002F37a3ff639d2cc687f3442562e70b4263.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002F708\\\u002F8b1\\\u002F7be\\\u002F7088b17be97ead2bfc8ea5b2ca39979b.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002Fe70\\\u002Ffef\\\u002Fac8\\\u002Fe70fefac8bb0141b43eb0ae3200cb3d0.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002Ffe9\\\u002Fd49\\\u002Fca4\\\u002Ffe9d49ca448a7e212db0f535e7feeca8.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002F111\\\u002Fd46\\\u002F39d\\\u002F111d4639dbda82505ca79cad7c7a65d9.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002F494\\\u002F4e0\\\u002Ff5b\\\u002F4944e0f5b179a8cbb82dda9b73c4c4aa.png\",\"http:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage2\\\u002Fb95\\\u002Ffe4\\\u002F868\\\u002Fb95fe486831408e68c8697f942375c83.png\"]}","metaDescription":"Здравствуй, Хабр. Большинство из нас так или иначе работает со строками. Этого не избежать — если ты пишешь код, ты обречен каждый день складывать строки, разбивать их на составные части и обращаться...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":["688948","688590","102364","144736","535316","210296","267855","342674","69424","267037"],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"algorithms"},"comments":{"articleComments":{"144736":{"refs":{"4861882":{"id":"4861882","parentId":null,"level":0,"timePublished":"2012-05-29T08:25:26+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EКлассная штука Rope, да. Только на Хабре уже \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F112394\u002F\"\u003Eбыла\u003C\u002Fa\u003E, хотя и не так конкретно.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"49109","alias":"Skiminok","fullname":"Александр Полозов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd23\u002Fed4\u002F4cf\u002Fd23ed44cf8d9f76e24a0a2a39616553a.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4861937"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861886":{"id":"4861886","parentId":null,"level":0,"timePublished":"2012-05-29T08:26:06+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":6,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНу конечно медленно, если не использовать StringBuilder (в C#, в других яп думаю тоже есть аналоги):\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cs\"\u003EStringBuilder sb = new StringBuilder(String.empty);\nfor (int i = 0; i &lt; 100000; i++) sb.Append(\"a\");\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60331","alias":"Nigrimmist","fullname":"Никита Василевский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fe18\u002F6db\u002F94e\u002Fe186db94ea04befce3e0c07b4eb9aa1e.jpg","speciality":"Senior Backend Developer"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4861955","4861965","4861986","4864964","4866700"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861894":{"id":"4861894","parentId":null,"level":0,"timePublished":"2012-05-29T08:27:32+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":5,"votesCount":7,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМне кажется в этом случае сильно возрастает сложность алгоритма сравнения строк, а соответсвенно и сортировки.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"52920","alias":"maxidler","fullname":"Maxim Antonov","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8e5\u002F6f2\u002Ff24\u002F8e56f2f2457df0b79da2deb37e1b537d.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4861910","4861982","4862038"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861903":{"id":"4861903","parentId":null,"level":0,"timePublished":"2012-05-29T08:29:14+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EИнтересный способ. Возможно, имело-бы смысл использовать nested sets для каких-то операций (веса — похожий прием, но не много не тот). Интуитивно мне кажется что при этом не пострадает скорость операций.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"63599","alias":"UncleAndy","fullname":"Андрей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F165\u002F85b\u002F970\u002F16585b97067cf198684868467e794676.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861910":{"id":"4861910","parentId":"4861894","level":1,"timePublished":"2012-05-29T08:30:05+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EДа, тоже подумал как такие строки будут в регулярных выражениях обрабатываться. :) Но если такой необходимости нет по задаче — почему нет?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"63599","alias":"UncleAndy","fullname":"Андрей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F165\u002F85b\u002F970\u002F16585b97067cf198684868467e794676.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861937":{"id":"4861937","parentId":"4861882","level":1,"timePublished":"2012-05-29T08:34:16+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":3,"votesCount":3,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EИ верно. Признаюсь, не нашел этот топик поиском — выдает лишь результаты типа «Cut the rope» и им подобные. В любом случае, подробное рассмотрение структуры думаю не помешает — уж больно мало про неё информации в рунете встечается.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer"},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861955":{"id":"4861955","parentId":"4861886","level":1,"timePublished":"2012-05-29T08:37:28+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EТам как раз в следующем абзаце про такие билдеры написано. Это классический код с объяснением почему нельзя складывать строки именно таким образом.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer"},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861965":{"id":"4861965","parentId":"4861886","level":1,"timePublished":"2012-05-29T08:39:32+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЛибо StringBuilder(), либо String.Format()\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"45","alias":"bask","fullname":"bask","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fb22\u002F464\u002F91e\u002Fb2246491ed722de679def797d654ff4b.png","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861982":{"id":"4861982","parentId":"4861894","level":1,"timePublished":"2012-05-29T08:42:53+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСо сравнением строк все нормально как раз. Сравнение требует последовательного перебора символов который за счет кэширования последнего индекса работает быстро. Порядок сложности не увеличится, увеличится только константа.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer"},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4861986":{"id":"4861986","parentId":"4861886","level":1,"timePublished":"2012-05-29T08:43:16+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":-4,"votesCount":10,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EStringBuilder сильно проигрывает Ropes\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"9353","alias":"sneer","fullname":"sneer","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4862304","4862390","4865508"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862038":{"id":"4862038","parentId":"4861894","level":1,"timePublished":"2012-05-29T08:50:46+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНет, сложность алгоритма не возрастёт, а останется прежней = o(n), где n — длина строки.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"79649","alias":"serso","fullname":"Sergey Solovyev","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faac\u002F077\u002F527\u002Faac07752700b22fbef7a0756166a89ba.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862100":{"id":"4862100","parentId":null,"level":0,"timePublished":"2012-05-29T09:00:21+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСпасибо за статью (и ссылки), познавательно!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗЫ: Кмк получаемое дерево все-таки не двоичное дерево \u003Ci\u003Eпоиска\u003C\u002Fi\u003E, нет? \u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"63342","alias":"nickme","fullname":"Николай Ершов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F18c\u002F74e\u002F281\u002F18c74e2810fc28eff60c9f7f31dc7eb4.png","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4862134"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862134":{"id":"4862134","parentId":"4862100","level":1,"timePublished":"2012-05-29T09:05:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ строгой формулировке, конечно, нет. Но при индексации символа аналогия с BST наиболее естественная — мы просто ищем другие объекты и правило выбора очередного узла немного модифицировано.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer"},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862304":{"id":"4862304","parentId":"4861986","level":2,"timePublished":"2012-05-29T09:33:32+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EУ вас и имплементация Rope есть, наверное, для .NET?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"61208","alias":"Weageoo","fullname":"Александр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F6a8\u002F894\u002F930\u002F6a889493036fd5f8f4489a37fccb17f7.png","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862338":{"id":"4862338","parentId":null,"level":0,"timePublished":"2012-05-29T09:38:09+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":6,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЯ в свой проекте на Delphi был вынужден что-то подобное строить. У меня строки доходили до 2 500 000 символов, и беда была не в скорости, а в проблеме сегментации строк. Эта проблема вызывала exception «out of mem».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледует упомянуть, что для Delphi 7 (на других не проверял), такой подход помимо скорости дает и прирост отказоустойчивости. \u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"64165","alias":"TheHorse","fullname":"Степан","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F92a\u002F807\u002F6da\u002F92a8076da7316357041660b7ebcafb95.png","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862390":{"id":"4862390","parentId":"4861986","level":2,"timePublished":"2012-05-29T09:45:31+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EДаешь бенчмарки!\u003Cbr\u002F\u003E\r\nМой прогноз — незначительная разница при построении строки, а при сравнении строк огромный, в несколько порядков отрыв по скорости «обычного порошка» от веревочных строк.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"80831","alias":"B08AH","fullname":null,"avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4863624"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862446":{"id":"4862446","parentId":null,"level":0,"timePublished":"2012-05-29T09:53:14+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EА есть готовая интерпретация на C++?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"64958","alias":"appplemac","fullname":"Alexey","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F495\u002F8b5\u002Fbf1\u002F4958b5bf1e00d3641d119a4a91423cef.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4862606"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862606":{"id":"4862606","parentId":"4862446","level":1,"timePublished":"2012-05-29T10:22:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EУ \u003Ca href=\"http:\u002F\u002Fwww.sgi.com\u002F\"\u003ESGI\u003C\u002Fa\u003E есть \u003Ca href=\"http:\u002F\u002Fwww.sgi.com\u002Ftech\u002Fstl\u002Fdownload.html\"\u003Eимплементация STL\u003C\u002Fa\u003E в которой есть \u003Ca href=\"http:\u002F\u002Fwww.sgi.com\u002Ftech\u002Fstl\u002FRope.html\"\u003Eсоответствующий контейнер\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"60712","alias":"Flux","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbb9\u002F0be\u002F68a\u002Fbb90be68abfe3b53041bf6f9143f44a2.jpg","speciality":"ML engineer"},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4862918":{"id":"4862918","parentId":null,"level":0,"timePublished":"2012-05-29T11:32:10+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EКак тут уже говорили, даешь бенчмарки! :)\u003Cbr\u002F\u003E\r\nЕщё интересно, как давно вам приходилось соединять 100 000 строк в цикле?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"63791","alias":"Goder","fullname":"Goder","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F444\u002F83b\u002Fc8d\u002F44483bc8d11fe722ca8f1fec89799603.jpg","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4864705"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4863612":{"id":"4863612","parentId":null,"level":0,"timePublished":"2012-05-29T13:51:55+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EХотелось бы обозначить область применимости такого хранения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПервый ваш пример уже вызывает сомнения. Что будет в памяти после\u003Cbr\u002F\u003E\r\nfor (int i = 0; i &lt; 100000; i++) s += «a»;\u003Cbr\u002F\u003E\r\nБудет ли это лучше StringBuilder?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"62128","alias":"ComodoHacker","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F757\u002F219\u002F8d4\u002F7572198d49e15fd09b77918367b1790c.png","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4864190"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4863624":{"id":"4863624","parentId":"4862390","level":3,"timePublished":"2012-05-29T13:55:00+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ca href=\"http:\u002F\u002Fwww.ibm.com\u002Fdeveloperworks\u002Fjava\u002Flibrary\u002Fj-ropes\u002F\"\u003Ewww.ibm.com\u002Fdeveloperworks\u002Fjava\u002Flibrary\u002Fj-ropes\u002F\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"9353","alias":"sneer","fullname":"sneer","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4864482"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864190":{"id":"4864190","parentId":"4863612","level":1,"timePublished":"2012-05-29T17:03:38+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EОб области применения можно почитать немного здесь: \u003Ca href=\"http:\u002F\u002Fwww.ibm.com\u002Fdeveloperworks\u002Fjava\u002Flibrary\u002Fj-ropes\u002F\"\u003Ewww.ibm.com\u002Fdeveloperworks\u002Fjava\u002Flibrary\u002Fj-ropes\u002F\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"30915","alias":"Juster","fullname":"Александр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F098\u002Faba\u002Ff93\u002F098abaf9337ea268ceb4e9311784f079.jpg","speciality":"software developer | c++, go, python, linux"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4864736"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864201":{"id":"4864201","parentId":null,"level":0,"timePublished":"2012-05-29T17:06:10+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЯ обычно использую массив строк.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТем более конкатенация для много-много-много строк требуется как правило один раз (для вывода, например, в поток, в который, кстати можно скормить массив и без конкатенации).\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"64596","alias":"mclander","fullname":"Максименко Александр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F4cc\u002Fa18\u002F2d1\u002F4cca182d17aa40fc9aabd56bcbb2eb27.png","speciality":"Разработчик"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864396":{"id":"4864396","parentId":null,"level":0,"timePublished":"2012-05-29T18:12:07+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВот такие строки в WebKit используются.\u003Cbr\u002F\u003E\r\nИ не всегда это хорошо — ибо эта зараза будет каждый раз при обращении к строке ее собирать.\u003Cbr\u002F\u003E\r\nИногда крайне не приятно и не понятно получается\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"25990","alias":"kashey","fullname":"Корзунов Антон","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F902\u002Fc7a\u002F49b\u002F902c7a49be188965de879f924b676efc.jpg","speciality":"javascript, webgl, maps, react, орфография(нет)"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864482":{"id":"4864482","parentId":"4863624","level":4,"timePublished":"2012-05-29T18:35:24+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EОжидаемо операции на «результирующей» строке медленнее, в частности и без того медленные регулярные выражения(в 2-10 раз медленннее с#\u002FJava кода \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F126954\u002F\"\u003Ehabrahabr.ru\u002Fpost\u002F126954\u002F\u003C\u002Fa\u003E — например ) еще в 3-30 раз замедляются.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПотестил StringBuilder в С#, Append скейлится линейно, в 10 раз увеличил количество итераций — в 10 раз выросло время, а вот Insert, как и в этих бенчмарках, геометрической прогрессией растет.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозможно имеет смысл конструировать строку этим методом(сделать RopeBuilder какой нибудь), если нужен именно быстрый Insert, а затем так же как и StringBuilder экспортировать в обычную immutable строку, в которой быстрее другие операции.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"80831","alias":"B08AH","fullname":null,"avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864705":{"id":"4864705","parentId":"4862918","level":1,"timePublished":"2012-05-29T19:48:08+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ 2007 году на ICFP Contest'e, когда \u003Ca href=\"http:\u002F\u002Fsave-endo.cs.uu.nl\u002F\"\u003Eспасали Endo\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fsave-endo.cs.uu.nl\u002F\"\u003Esave-endo.cs.uu.nl\u002F\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nПохожую структуру и применяли.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ практических задачах — вряд ли встретится, но структура хороша, если стоит задача в быстрой генерации больших текстовых данных.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"62900","alias":"Kilew","fullname":"Павел Тайкало","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F21b\u002F007\u002F443\u002F21b0074437446eb4f9a92215c7e90add.jpg","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864736":{"id":"4864736","parentId":"4864190","level":2,"timePublished":"2012-05-29T19:57:18+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСпасибо. Ее качественный перевод с успехом заменил бы эту статью. :)\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"62128","alias":"ComodoHacker","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F757\u002F219\u002F8d4\u002F7572198d49e15fd09b77918367b1790c.png","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864836":{"id":"4864836","parentId":null,"level":0,"timePublished":"2012-05-29T20:26:21+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":-2,"votesCount":4,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EА для питона есть адекватная реализация?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"26501","alias":"kaaquantum","fullname":"Andrew ks1v Kiselev","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F469\u002Fbe3\u002F891\u002F469be3891f024cea803b6be71ffc8200.jpg","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4868115"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4864964":{"id":"4864964","parentId":"4861886","level":1,"timePublished":"2012-05-29T21:18:40+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EИнтересно, одноимённый класс в Java работает так же, как и в C#?\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"127510","alias":"GreatKoshak","fullname":"Руслан Котов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F130\u002F2fa\u002F521\u002F1302fa521a5aebdc5839fb85755279f0.jpg","speciality":"Full-stack Software Engineer"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4865089":{"id":"4865089","parentId":null,"level":0,"timePublished":"2012-05-29T22:36:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EОк, все вроде так офигенно, но… Данный паттерн используется повсеместно и, к сожалению не является серебрянной пулей. Такие решения применяются для более узконаправленных типов данных, что как бы обоснованно (на основе данных профилированния). Но если говорить о строках, ребята настолько разнообразно ими пользуются, что сделать серьезно эффективнее чем strcmp или strcpy (ок, плюсовые варианты) ну нет, чудес не бывает. Либо память, либо такты. Ну либо более специализированные варианты, которые привели выше.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"24526","alias":"ivertex","fullname":"ivertex","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["4865507"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4865507":{"id":"4865507","parentId":"4865089","level":1,"timePublished":"2012-05-30T06:33:38+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМне понравилось как это реализовано в C# — обе эти операции фактически являются сравнением двух ссылок(strcmp), и присвоением ссылки(strcpy).\u003Cbr\u002F\u003E\r\nС ограничением — сравнение только на предмет равно-не равно, а не для сортировки больше-меньше.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"80831","alias":"B08AH","fullname":null,"avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4865508":{"id":"4865508","parentId":"4861986","level":2,"timePublished":"2012-05-30T06:33:48+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EА я оставлю пару комментариев Эрика Липперта:\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fstackoverflow.com\u002Fq\u002F1862703\u002F1285120\"\u003E1:\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EIf you have a scenario where this data structure is more optimal than a string builder, I would be curious to know what it is. It has been my experience that rope data structures are almost never a win over the raw speed of native string or string builder operations in typical cases, so I am very interested to see realistic scenarios where its a win.\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fstackoverflow.com\u002Fq\u002F1863440\u002F1285120\"\u003E2:\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EMy experience is admittedly limited; I've tried to add rope-style string representations to languages like VBScript and JScript. The number of cases in which we must aggressively reify internal strings into «real» buffer-based strings was so large, and the number of cases where runtime string manipulations actually grew large, complex strings was so small, that the net perf impact was negative. When we built the string logic in JScript.NET we simply used a stringbuilder rather than attempting ropes again.\u003C\u002Fblockquote\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"47269","alias":"Xitsa","fullname":"Бушуев Стас","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F023\u002F371\u002Faa3\u002F023371aa312aa5990078153ce00203be.png","speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4865651":{"id":"4865651","parentId":null,"level":0,"timePublished":"2012-05-30T07:30:50+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003Eесли не ошибаюсь, то у libevent буфер-ы так и работают\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"34877","alias":"Aco","fullname":"Иван","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F427\u002Fc95\u002Fb4d\u002F427c95b4d0fd1a8626ec20a426d9dda1.jpg","speciality":"Программист, Web-разработчик"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4866700":{"id":"4866700","parentId":"4861886","level":1,"timePublished":"2012-05-30T12:07:32+00:00","timeChanged":null,"isSuspended":false,"status":"author_deactivated","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНЛО прилетело и опубликовало эту надпись здесь\u003C\u002Fdiv\u003E","editorVersion":0,"author":{},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"4868115":{"id":"4868115","parentId":"4864836","level":1,"timePublished":"2012-05-30T20:27:51+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EА минусы то за что?!\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"26501","alias":"kaaquantum","fullname":"Andrew ks1v Kiselev","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F469\u002Fbe3\u002F891\u002F469be3891f024cea803b6be71ffc8200.jpg","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"7359407":{"id":"7359407","parentId":null,"level":0,"timePublished":"2014-02-27T12:49:09+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПохожая структура Twine используется в \u003Ca href=\"http:\u002F\u002Fllvm.org\u002Fdocs\u002FProgrammersManual.html#llvm-adt-twine-h\"\u003ELLVM\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМожно также заметить, что такую структуру данных можно сделать персистентной и использовать для реализации функционала DO-UNDO. Правда, деталей реализации у такого решения довольно много.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"106143","alias":"roman_kashitsyn","fullname":"Роман Кашицын","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faa2\u002F099\u002Fccd\u002Faa2099ccdec6880411b60a4dc3b335d7.png","speciality":"Пользователь"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false}},"root":["4861882","4861886","4861894","4861903","4862100","4862338","4862446","4862918","4863612","4864201","4864396","4864836","4865089","4865651","7359407"]}},"articlePinnedComments":{"144736":{"refs":{},"commentIds":[]}},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{"isCanComment":false,"cantCommentReasonKey":"AUTH_REQUIRED","cantCommentReason":"Authorization required","data":null},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":1393505349,"moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"tasks":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"technotext":{"nominationsList":[]},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.a3ff8f09.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.344a2afd.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
